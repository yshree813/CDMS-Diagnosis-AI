{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"id":"cNmA0o8ufOFJ","executionInfo":{"status":"ok","timestamp":1766898225963,"user_tz":-330,"elapsed":4583,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"}}},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n","%matplotlib inline"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":461},"executionInfo":{"elapsed":238,"status":"ok","timestamp":1766898229184,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"gFJ6s6LmfXn1","outputId":"b2004005-e134-49bf-98fb-9155d0c052d1"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["     cat__Varicella_1  cat__Varicella_2  cat__Varicella_3  \\\n","0                   1                 0                 0   \n","1                   0                 1                 0   \n","2                   1                 0                 0   \n","3                   1                 0                 0   \n","4                   1                 0                 0   \n","..                ...               ...               ...   \n","268                 1                 0                 0   \n","269                 0                 0                 1   \n","270                 0                 0                 1   \n","271                 0                 0                 1   \n","272                 0                 0                 1   \n","\n","     cat__Mono or polysymptomatic_1  cat__Mono or polysymptomatic_2  \\\n","0                                 1                               0   \n","1                                 0                               1   \n","2                                 1                               0   \n","3                                 0                               1   \n","4                                 0                               1   \n","..                              ...                             ...   \n","268                               0                               1   \n","269                               0                               1   \n","270                               0                               1   \n","271                               0                               1   \n","272                               1                               0   \n","\n","     cat__Mono or polysymptomatic_3  cat__Oligoclonal bands_0  \\\n","0                                 0                         1   \n","1                                 0                         0   \n","2                                 0                         0   \n","3                                 0                         0   \n","4                                 0                         1   \n","..                              ...                       ...   \n","268                               0                         1   \n","269                               0                         0   \n","270                               0                         1   \n","271                               0                         0   \n","272                               0                         1   \n","\n","     cat__Oligoclonal bands_1  cat__Oligoclonal bands_2  \\\n","0                           0                         0   \n","1                           1                         0   \n","2                           1                         0   \n","3                           1                         0   \n","4                           0                         0   \n","..                        ...                       ...   \n","268                         0                         0   \n","269                         1                         0   \n","270                         0                         0   \n","271                         1                         0   \n","272                         0                         0   \n","\n","     cat__initial EDSS_1.0  ...  remainder__Age (y)  remainder__LLSSEP  \\\n","0                        1  ...                  34                  1   \n","1                        0  ...                  61                  1   \n","2                        1  ...                  22                  0   \n","3                        1  ...                  41                  0   \n","4                        1  ...                  34                  1   \n","..                     ...  ...                 ...                ...   \n","268                      1  ...                  31                  0   \n","269                      1  ...                  21                  0   \n","270                      1  ...                  19                  1   \n","271                      1  ...                  32                  1   \n","272                      1  ...                  77                  0   \n","\n","     remainder__ULSSEP  remainder__VEP  remainder__BAEP  \\\n","0                    1               0                0   \n","1                    0               1                0   \n","2                    0               0                0   \n","3                    1               1                0   \n","4                    0               0                0   \n","..                 ...             ...              ...   \n","268                  0               0                0   \n","269                  0               0                0   \n","270                  1               1                0   \n","271                  1               1                0   \n","272                  1               0                0   \n","\n","     remainder__Periventricular MRI  remainder__Cortical MRI  \\\n","0                                 0                        1   \n","1                                 0                        0   \n","2                                 0                        1   \n","3                                 1                        1   \n","4                                 1                        0   \n","..                              ...                      ...   \n","268                               0                        0   \n","269                               0                        0   \n","270                               0                        0   \n","271                               1                        1   \n","272                               0                        0   \n","\n","     remainder__Infratentorial MRI  remainder__Spinal cord MRI  \\\n","0                                0                           1   \n","1                                0                           1   \n","2                                0                           0   \n","3                                0                           0   \n","4                                0                           0   \n","..                             ...                         ...   \n","268                              0                           0   \n","269                              0                           1   \n","270                              0                           1   \n","271                              1                           0   \n","272                              0                           0   \n","\n","     remainder__group  \n","0                   1  \n","1                   1  \n","2                   1  \n","3                   1  \n","4                   1  \n","..                ...  \n","268                 0  \n","269                 0  \n","270                 0  \n","271                 0  \n","272                 0  \n","\n","[273 rows x 42 columns]"],"text/html":["\n","  <div id=\"df-a0e1079b-87c0-40a2-bb81-1178dc8124d5\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>cat__Varicella_1</th>\n","      <th>cat__Varicella_2</th>\n","      <th>cat__Varicella_3</th>\n","      <th>cat__Mono or polysymptomatic_1</th>\n","      <th>cat__Mono or polysymptomatic_2</th>\n","      <th>cat__Mono or polysymptomatic_3</th>\n","      <th>cat__Oligoclonal bands_0</th>\n","      <th>cat__Oligoclonal bands_1</th>\n","      <th>cat__Oligoclonal bands_2</th>\n","      <th>cat__initial EDSS_1.0</th>\n","      <th>...</th>\n","      <th>remainder__Age (y)</th>\n","      <th>remainder__LLSSEP</th>\n","      <th>remainder__ULSSEP</th>\n","      <th>remainder__VEP</th>\n","      <th>remainder__BAEP</th>\n","      <th>remainder__Periventricular MRI</th>\n","      <th>remainder__Cortical MRI</th>\n","      <th>remainder__Infratentorial MRI</th>\n","      <th>remainder__Spinal cord MRI</th>\n","      <th>remainder__group</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>...</td>\n","      <td>34</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>61</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>...</td>\n","      <td>22</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>...</td>\n","      <td>41</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>...</td>\n","      <td>34</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>268</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>...</td>\n","      <td>31</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>269</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>...</td>\n","      <td>21</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>270</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>...</td>\n","      <td>19</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>271</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>...</td>\n","      <td>32</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>272</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>...</td>\n","      <td>77</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>273 rows × 42 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a0e1079b-87c0-40a2-bb81-1178dc8124d5')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-a0e1079b-87c0-40a2-bb81-1178dc8124d5 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-a0e1079b-87c0-40a2-bb81-1178dc8124d5');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","    <div id=\"df-66fbfd72-b2d7-4914-a720-3dc6de5c6dd2\">\n","      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-66fbfd72-b2d7-4914-a720-3dc6de5c6dd2')\"\n","                title=\"Suggest charts\"\n","                style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","      </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","      <script>\n","        async function quickchart(key) {\n","          const quickchartButtonEl =\n","            document.querySelector('#' + key + ' button');\n","          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","          quickchartButtonEl.classList.add('colab-df-spinner');\n","          try {\n","            const charts = await google.colab.kernel.invokeFunction(\n","                'suggestCharts', [key], {});\n","          } catch (error) {\n","            console.error('Error during call to suggestCharts:', error);\n","          }\n","          quickchartButtonEl.classList.remove('colab-df-spinner');\n","          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","        }\n","        (() => {\n","          let quickchartButtonEl =\n","            document.querySelector('#df-66fbfd72-b2d7-4914-a720-3dc6de5c6dd2 button');\n","          quickchartButtonEl.style.display =\n","            google.colab.kernel.accessAllowed ? 'block' : 'none';\n","        })();\n","      </script>\n","    </div>\n","\n","  <div id=\"id_6c15dd42-9104-49b0-b166-606ce37bdd5c\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('data')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_6c15dd42-9104-49b0-b166-606ce37bdd5c button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('data');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"data"}},"metadata":{},"execution_count":2}],"source":["data=pd.read_csv('/content/data_encoded.csv')\n","data"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":178},"executionInfo":{"elapsed":47,"status":"ok","timestamp":1766840347798,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"YBUiyApEfd4L","outputId":"db8ce686-7cf1-4128-f925-047ed76401b1"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["remainder__group\n","0    148\n","1    125\n","Name: count, dtype: int64"],"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>count</th>\n","    </tr>\n","    <tr>\n","      <th>remainder__group</th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>148</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>125</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div><br><label><b>dtype:</b> int64</label>"]},"metadata":{},"execution_count":3}],"source":["data['remainder__group'].value_counts()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"B0Q4aFMmma7q"},"outputs":[],"source":["from sklearn.feature_selection import mutual_info_classif\n","\n","mi = mutual_info_classif(data.drop(columns=['remainder__group']), data['remainder__group'], random_state=42)\n","\n","mi_df = pd.DataFrame({\n","    'feature': data.drop(columns=['remainder__group']).columns,\n","    'MI_score': mi\n","}).sort_values(by='MI_score', ascending=False)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XGLl6ztmmbZ7"},"outputs":[],"source":["mi_df = mi_df[mi_df['MI_score'] > 0.00]\n","imp_feat=mi_df['feature'].tolist()\n","feat=data[imp_feat]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":478},"executionInfo":{"elapsed":21,"status":"ok","timestamp":1766819742854,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"eCn5_WyDmbgH","outputId":"7280c93b-8bd9-4617-d98b-17971f84149b"},"outputs":[{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"feat"},"text/html":["\n","  <div id=\"df-aa8de731-7e1f-4773-9163-d71dc78d901e\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>remainder__Periventricular MRI</th>\n","      <th>cat__initial EDSS_1.0</th>\n","      <th>cat__ final EDSS_1.0</th>\n","      <th>cat__ final EDSS_2.0</th>\n","      <th>remainder__Infratentorial MRI</th>\n","      <th>cat__initial symptom_11.0</th>\n","      <th>cat__Oligoclonal bands_1</th>\n","      <th>remainder__VEP</th>\n","      <th>cat__Varicella_3</th>\n","      <th>cat__initial EDSS_2.0</th>\n","      <th>...</th>\n","      <th>cat__initial symptom_15.0</th>\n","      <th>remainder__Gender</th>\n","      <th>cat__initial symptom_10.0</th>\n","      <th>remainder__Cortical MRI</th>\n","      <th>cat__Mono or polysymptomatic_1</th>\n","      <th>cat__initial symptom_4.0</th>\n","      <th>cat__ final EDSS_3.0</th>\n","      <th>cat__initial symptom_13.0</th>\n","      <th>cat__Varicella_1</th>\n","      <th>remainder__ULSSEP</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>268</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>269</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>270</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>271</th>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>272</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>273 rows × 29 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-aa8de731-7e1f-4773-9163-d71dc78d901e')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-aa8de731-7e1f-4773-9163-d71dc78d901e button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-aa8de731-7e1f-4773-9163-d71dc78d901e');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","    <div id=\"df-742fc731-2bcf-4999-9a83-db8408e844a3\">\n","      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-742fc731-2bcf-4999-9a83-db8408e844a3')\"\n","                title=\"Suggest charts\"\n","                style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","      </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","      <script>\n","        async function quickchart(key) {\n","          const quickchartButtonEl =\n","            document.querySelector('#' + key + ' button');\n","          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","          quickchartButtonEl.classList.add('colab-df-spinner');\n","          try {\n","            const charts = await google.colab.kernel.invokeFunction(\n","                'suggestCharts', [key], {});\n","          } catch (error) {\n","            console.error('Error during call to suggestCharts:', error);\n","          }\n","          quickchartButtonEl.classList.remove('colab-df-spinner');\n","          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","        }\n","        (() => {\n","          let quickchartButtonEl =\n","            document.querySelector('#df-742fc731-2bcf-4999-9a83-db8408e844a3 button');\n","          quickchartButtonEl.style.display =\n","            google.colab.kernel.accessAllowed ? 'block' : 'none';\n","        })();\n","      </script>\n","    </div>\n","\n","  <div id=\"id_abbc4ed0-91a9-4d47-8327-dcfb5382c0de\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('feat')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_abbc4ed0-91a9-4d47-8327-dcfb5382c0de button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('feat');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"text/plain":["     remainder__Periventricular MRI  cat__initial EDSS_1.0  \\\n","0                                 0                      1   \n","1                                 0                      0   \n","2                                 0                      1   \n","3                                 1                      1   \n","4                                 1                      1   \n","..                              ...                    ...   \n","268                               0                      1   \n","269                               0                      1   \n","270                               0                      1   \n","271                               1                      1   \n","272                               0                      1   \n","\n","     cat__ final EDSS_1.0  cat__ final EDSS_2.0  \\\n","0                       1                     0   \n","1                       0                     1   \n","2                       1                     0   \n","3                       1                     0   \n","4                       1                     0   \n","..                    ...                   ...   \n","268                     1                     0   \n","269                     1                     0   \n","270                     1                     0   \n","271                     1                     0   \n","272                     1                     0   \n","\n","     remainder__Infratentorial MRI  cat__initial symptom_11.0  \\\n","0                                0                          0   \n","1                                0                          0   \n","2                                0                          0   \n","3                                0                          0   \n","4                                0                          0   \n","..                             ...                        ...   \n","268                              0                          0   \n","269                              0                          0   \n","270                              0                          0   \n","271                              1                          0   \n","272                              0                          0   \n","\n","     cat__Oligoclonal bands_1  remainder__VEP  cat__Varicella_3  \\\n","0                           0               0                 0   \n","1                           1               1                 0   \n","2                           1               0                 0   \n","3                           1               1                 0   \n","4                           0               0                 0   \n","..                        ...             ...               ...   \n","268                         0               0                 0   \n","269                         1               0                 1   \n","270                         0               1                 1   \n","271                         1               1                 1   \n","272                         0               0                 1   \n","\n","     cat__initial EDSS_2.0  ...  cat__initial symptom_15.0  remainder__Gender  \\\n","0                        0  ...                          0                  1   \n","1                        1  ...                          0                  1   \n","2                        0  ...                          0                  1   \n","3                        0  ...                          0                  0   \n","4                        0  ...                          0                  0   \n","..                     ...  ...                        ...                ...   \n","268                      0  ...                          0                  0   \n","269                      0  ...                          0                  1   \n","270                      0  ...                          0                  0   \n","271                      0  ...                          1                  0   \n","272                      0  ...                          0                  0   \n","\n","     cat__initial symptom_10.0  remainder__Cortical MRI  \\\n","0                            0                        1   \n","1                            1                        0   \n","2                            0                        1   \n","3                            0                        1   \n","4                            0                        0   \n","..                         ...                      ...   \n","268                          0                        0   \n","269                          0                        0   \n","270                          0                        0   \n","271                          0                        1   \n","272                          0                        0   \n","\n","     cat__Mono or polysymptomatic_1  cat__initial symptom_4.0  \\\n","0                                 1                         0   \n","1                                 0                         0   \n","2                                 1                         0   \n","3                                 0                         0   \n","4                                 0                         0   \n","..                              ...                       ...   \n","268                               0                         0   \n","269                               0                         0   \n","270                               0                         0   \n","271                               0                         0   \n","272                               1                         0   \n","\n","     cat__ final EDSS_3.0  cat__initial symptom_13.0  cat__Varicella_1  \\\n","0                       0                          0                 1   \n","1                       0                          0                 0   \n","2                       0                          0                 1   \n","3                       0                          0                 1   \n","4                       0                          0                 1   \n","..                    ...                        ...               ...   \n","268                     0                          0                 1   \n","269                     0                          0                 0   \n","270                     0                          1                 0   \n","271                     0                          0                 0   \n","272                     0                          0                 0   \n","\n","     remainder__ULSSEP  \n","0                    1  \n","1                    0  \n","2                    0  \n","3                    1  \n","4                    0  \n","..                 ...  \n","268                  0  \n","269                  0  \n","270                  1  \n","271                  1  \n","272                  1  \n","\n","[273 rows x 29 columns]"]},"execution_count":6,"metadata":{},"output_type":"execute_result"}],"source":["feat"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"TeBV6YIRiZYX"},"outputs":[],"source":["x=data.drop('remainder__group',axis=1)\n","y=data['remainder__group']"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"p79tDVoRji1W"},"outputs":[],"source":["from sklearn.model_selection import train_test_split\n","x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,stratify=y,random_state=42)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":444,"status":"ok","timestamp":1766819743311,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"w96-Jo1opFTd","outputId":"93733b91-34c3-47d8-9d4c-da9448da4d97"},"outputs":[{"name":"stdout","output_type":"stream","text":["(218, 41)\n","(218,)\n","(55, 41)\n","(55,)\n"]}],"source":["print(x_train.shape)\n","print(y_train.shape)\n","print(x_test.shape)\n","print(y_test.shape)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"yHv0Ax22hxmR"},"outputs":[],"source":["from imblearn.over_sampling import BorderlineSMOTE\n","Borderline = BorderlineSMOTE(random_state=42)\n","\n","x_train_res, y_train_res = Borderline.fit_resample(x_train, y_train)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":8,"status":"ok","timestamp":1766840363520,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"eC33YM0Gnmcl","outputId":"a585a82b-b8e1-4165-cb0b-ebe26209d40d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(236, 41)"]},"metadata":{},"execution_count":7}],"source":["x_train_res.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":29,"status":"ok","timestamp":1766840369592,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"KmrQPShfoEat","outputId":"2375569b-cdb0-495c-9571-dab17123ed38"},"outputs":[{"output_type":"stream","name":"stdout","text":["Before SMOTE: Counter({0: 118, 1: 100})\n","After SMOTE : Counter({0: 118, 1: 118})\n"]}],"source":["from collections import Counter\n","\n","print(\"Before SMOTE:\", Counter(y_train))\n","print(\"After SMOTE :\", Counter(y_train_res))\n"]},{"cell_type":"code","source":["# best_feat_38=[np.str_('cat__Varicella_1'),\n","#  np.str_('cat__Varicella_3'),\n","#  np.str_('cat__Mono or polysymptomatic_1'),\n","#  np.str_('cat__Mono or polysymptomatic_2'),\n","#  np.str_('cat__Mono or polysymptomatic_3'),\n","#  np.str_('cat__Oligoclonal bands_0'),\n","#  np.str_('cat__Oligoclonal bands_1'),\n","#  np.str_('cat__Oligoclonal bands_2'),\n","#  np.str_('cat__initial EDSS_1.0'),\n","#  np.str_('cat__initial EDSS_2.0'),\n","#  np.str_('cat__initial EDSS_3.0'),\n","#  np.str_('cat__initial symptom_1.0'),\n","#  np.str_('cat__initial symptom_2.0'),\n","#  np.str_('cat__initial symptom_3.0'),\n","#  np.str_('cat__initial symptom_4.0'),\n","#  np.str_('cat__initial symptom_5.0'),\n","#  np.str_('cat__initial symptom_6.0'),\n","#  np.str_('cat__initial symptom_7.0'),\n","#  np.str_('cat__initial symptom_8.0'),\n","#  np.str_('cat__initial symptom_9.0'),\n","#  np.str_('cat__initial symptom_10.0'),\n","#  np.str_('cat__initial symptom_11.0'),\n","#  np.str_('cat__initial symptom_12.0'),\n","#  np.str_('cat__initial symptom_13.0'),\n","#  np.str_('cat__initial symptom_14.0'),\n","#  np.str_('cat__initial symptom_15.0'),\n","#  np.str_('cat__initial symptom_nan'),\n","#  np.str_('cat__ final EDSS_1.0'),\n","#  np.str_('cat__ final EDSS_2.0'),\n","#  np.str_('cat__ final EDSS_3.0'),\n","#  np.str_('remainder__Gender'),\n","#  np.str_('remainder__Age (y)'),\n","#  np.str_('remainder__LLSSEP'),\n","#  np.str_('remainder__ULSSEP'),\n","#  np.str_('remainder__BAEP'),\n","#  np.str_('remainder__Periventricular MRI'),\n","#  np.str_('remainder__Cortical MRI'),\n","#  np.str_('remainder__Infratentorial MRI')]"],"metadata":{"id":"ilaaBdsJ5eZW"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# best_38_feat=data[best_feat_38]\n","# best_38_feat"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":478},"id":"EZDcY_EN5lME","executionInfo":{"status":"ok","timestamp":1766840579420,"user_tz":-330,"elapsed":293,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"}},"outputId":"040f0024-ab49-4f59-c167-6ecf6ba94f71"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["     cat__Varicella_1  cat__Varicella_3  cat__Mono or polysymptomatic_1  \\\n","0                   1                 0                               1   \n","1                   0                 0                               0   \n","2                   1                 0                               1   \n","3                   1                 0                               0   \n","4                   1                 0                               0   \n","..                ...               ...                             ...   \n","268                 1                 0                               0   \n","269                 0                 1                               0   \n","270                 0                 1                               0   \n","271                 0                 1                               0   \n","272                 0                 1                               1   \n","\n","     cat__Mono or polysymptomatic_2  cat__Mono or polysymptomatic_3  \\\n","0                                 0                               0   \n","1                                 1                               0   \n","2                                 0                               0   \n","3                                 1                               0   \n","4                                 1                               0   \n","..                              ...                             ...   \n","268                               1                               0   \n","269                               1                               0   \n","270                               1                               0   \n","271                               1                               0   \n","272                               0                               0   \n","\n","     cat__Oligoclonal bands_0  cat__Oligoclonal bands_1  \\\n","0                           1                         0   \n","1                           0                         1   \n","2                           0                         1   \n","3                           0                         1   \n","4                           1                         0   \n","..                        ...                       ...   \n","268                         1                         0   \n","269                         0                         1   \n","270                         1                         0   \n","271                         0                         1   \n","272                         1                         0   \n","\n","     cat__Oligoclonal bands_2  cat__initial EDSS_1.0  cat__initial EDSS_2.0  \\\n","0                           0                      1                      0   \n","1                           0                      0                      1   \n","2                           0                      1                      0   \n","3                           0                      1                      0   \n","4                           0                      1                      0   \n","..                        ...                    ...                    ...   \n","268                         0                      1                      0   \n","269                         0                      1                      0   \n","270                         0                      1                      0   \n","271                         0                      1                      0   \n","272                         0                      1                      0   \n","\n","     ...  cat__ final EDSS_2.0  cat__ final EDSS_3.0  remainder__Gender  \\\n","0    ...                     0                     0                  1   \n","1    ...                     1                     0                  1   \n","2    ...                     0                     0                  1   \n","3    ...                     0                     0                  0   \n","4    ...                     0                     0                  0   \n","..   ...                   ...                   ...                ...   \n","268  ...                     0                     0                  0   \n","269  ...                     0                     0                  1   \n","270  ...                     0                     0                  0   \n","271  ...                     0                     0                  0   \n","272  ...                     0                     0                  0   \n","\n","     remainder__Age (y)  remainder__LLSSEP  remainder__ULSSEP  \\\n","0                    34                  1                  1   \n","1                    61                  1                  0   \n","2                    22                  0                  0   \n","3                    41                  0                  1   \n","4                    34                  1                  0   \n","..                  ...                ...                ...   \n","268                  31                  0                  0   \n","269                  21                  0                  0   \n","270                  19                  1                  1   \n","271                  32                  1                  1   \n","272                  77                  0                  1   \n","\n","     remainder__BAEP  remainder__Periventricular MRI  remainder__Cortical MRI  \\\n","0                  0                               0                        1   \n","1                  0                               0                        0   \n","2                  0                               0                        1   \n","3                  0                               1                        1   \n","4                  0                               1                        0   \n","..               ...                             ...                      ...   \n","268                0                               0                        0   \n","269                0                               0                        0   \n","270                0                               0                        0   \n","271                0                               1                        1   \n","272                0                               0                        0   \n","\n","     remainder__Infratentorial MRI  \n","0                                0  \n","1                                0  \n","2                                0  \n","3                                0  \n","4                                0  \n","..                             ...  \n","268                              0  \n","269                              0  \n","270                              0  \n","271                              1  \n","272                              0  \n","\n","[273 rows x 38 columns]"],"text/html":["\n","  <div id=\"df-5bfad005-ba6d-4483-a769-da99af2a9db8\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>cat__Varicella_1</th>\n","      <th>cat__Varicella_3</th>\n","      <th>cat__Mono or polysymptomatic_1</th>\n","      <th>cat__Mono or polysymptomatic_2</th>\n","      <th>cat__Mono or polysymptomatic_3</th>\n","      <th>cat__Oligoclonal bands_0</th>\n","      <th>cat__Oligoclonal bands_1</th>\n","      <th>cat__Oligoclonal bands_2</th>\n","      <th>cat__initial EDSS_1.0</th>\n","      <th>cat__initial EDSS_2.0</th>\n","      <th>...</th>\n","      <th>cat__ final EDSS_2.0</th>\n","      <th>cat__ final EDSS_3.0</th>\n","      <th>remainder__Gender</th>\n","      <th>remainder__Age (y)</th>\n","      <th>remainder__LLSSEP</th>\n","      <th>remainder__ULSSEP</th>\n","      <th>remainder__BAEP</th>\n","      <th>remainder__Periventricular MRI</th>\n","      <th>remainder__Cortical MRI</th>\n","      <th>remainder__Infratentorial MRI</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>34</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>...</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>61</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>22</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>41</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>34</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>268</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>31</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>269</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>21</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>270</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>19</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>271</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>32</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>272</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>77</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>273 rows × 38 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5bfad005-ba6d-4483-a769-da99af2a9db8')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-5bfad005-ba6d-4483-a769-da99af2a9db8 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-5bfad005-ba6d-4483-a769-da99af2a9db8');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","    <div id=\"df-e9917982-6588-415b-adb3-59b79a785c58\">\n","      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-e9917982-6588-415b-adb3-59b79a785c58')\"\n","                title=\"Suggest charts\"\n","                style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","      </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","      <script>\n","        async function quickchart(key) {\n","          const quickchartButtonEl =\n","            document.querySelector('#' + key + ' button');\n","          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","          quickchartButtonEl.classList.add('colab-df-spinner');\n","          try {\n","            const charts = await google.colab.kernel.invokeFunction(\n","                'suggestCharts', [key], {});\n","          } catch (error) {\n","            console.error('Error during call to suggestCharts:', error);\n","          }\n","          quickchartButtonEl.classList.remove('colab-df-spinner');\n","          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","        }\n","        (() => {\n","          let quickchartButtonEl =\n","            document.querySelector('#df-e9917982-6588-415b-adb3-59b79a785c58 button');\n","          quickchartButtonEl.style.display =\n","            google.colab.kernel.accessAllowed ? 'block' : 'none';\n","        })();\n","      </script>\n","    </div>\n","\n","  <div id=\"id_6e6aea99-026f-4b10-9534-8558fda8f7f5\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('best_38_feat')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_6e6aea99-026f-4b10-9534-8558fda8f7f5 button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('best_38_feat');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"best_38_feat"}},"metadata":{},"execution_count":10}]},{"cell_type":"code","source":["# best_38_feat.to_csv('best_38_feat.csv',index=False)"],"metadata":{"id":"I73YA7dh5-q2"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# best_38_feat.shape"],"metadata":{"id":"JqfVOCHv6JDn","executionInfo":{"status":"ok","timestamp":1766840640770,"user_tz":-330,"elapsed":12,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"}},"outputId":"754e16d5-3dbb-447f-9c50-15186287b37b","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(273, 38)"]},"metadata":{},"execution_count":12}]},{"cell_type":"code","execution_count":null,"metadata":{"id":"F7Rt40bGqt_b"},"outputs":[],"source":["from sklearn.ensemble import RandomForestClassifier\n","\n","model = RandomForestClassifier(random_state=42, n_jobs=-1)\n","model.fit(x_train_res, y_train_res)\n","y_pred = model.predict(x_test)\n","y_prob = model.predict_proba(x_test)[:,1]\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":35,"status":"ok","timestamp":1766819743941,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"FanxxSboq7Lz","outputId":"7edc158e-9318-416b-d05f-249dd67a7519"},"outputs":[{"name":"stdout","output_type":"stream","text":["Accuracy: 0.8909090909090909\n","              precision    recall  f1-score   support\n","\n","           0       0.90      0.90      0.90        30\n","           1       0.88      0.88      0.88        25\n","\n","    accuracy                           0.89        55\n","   macro avg       0.89      0.89      0.89        55\n","weighted avg       0.89      0.89      0.89        55\n","\n","Confusion matrix:\n"," [[27  3]\n"," [ 3 22]]\n","ROC AUC: 0.9500000000000001\n","PR AUC (average precision): 0.954429272676641\n"]}],"source":["from sklearn.metrics import classification_report, confusion_matrix, roc_auc_score, average_precision_score,accuracy_score\n","\n","print(\"Accuracy:\", accuracy_score(y_test, y_pred))\n","\n","print(classification_report(y_test, y_pred))\n","print(\"Confusion matrix:\\n\", confusion_matrix(y_test, y_pred))\n","print(\"ROC AUC:\", roc_auc_score(y_test, y_prob))\n","print(\"PR AUC (average precision):\", average_precision_score(y_test, y_prob))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1766819743950,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"9-J4pfDoq_fb","outputId":"192adeab-3ef4-459f-bb4f-f9216408b700"},"outputs":[{"data":{"text/plain":["{'bootstrap': True,\n"," 'ccp_alpha': 0.0,\n"," 'class_weight': None,\n"," 'criterion': 'gini',\n"," 'max_depth': None,\n"," 'max_features': 'sqrt',\n"," 'max_leaf_nodes': None,\n"," 'max_samples': None,\n"," 'min_impurity_decrease': 0.0,\n"," 'min_samples_leaf': 1,\n"," 'min_samples_split': 2,\n"," 'min_weight_fraction_leaf': 0.0,\n"," 'monotonic_cst': None,\n"," 'n_estimators': 100,\n"," 'n_jobs': -1,\n"," 'oob_score': False,\n"," 'random_state': 42,\n"," 'verbose': 0,\n"," 'warm_start': False}"]},"execution_count":15,"metadata":{},"output_type":"execute_result"}],"source":["model.get_params()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"ILvr2uu-xu4u"},"outputs":[],"source":["from sklearn.experimental import enable_halving_search_cv  # noqa\n","from sklearn.model_selection import HalvingGridSearchCV\n","\n","param_grid = {\n","                 'max_features': ['log2'], # Removed 'auto' as it's deprecated\n","                 'max_depth' : [4,5,6,7,10,15],\n","                 'min_samples_split' :[2,3,4,5,6],\n","                 'max_samples': [50,100,150]} # Adjusted max_samples to prevent ValueError\n","search = HalvingGridSearchCV(model, param_grid, resource='n_estimators',\n","                             max_resources=200, # Set max_resources to the desired maximum for n_estimators\n","                             random_state=42).fit(x_train_res, y_train_res)\n","search.best_params_\n","y_pred = search.best_estimator_.predict(x_test)\n","y_prob = search.best_estimator_.predict_proba(x_test)[:,1]"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"O3TvEtBY3-wj"},"outputs":[],"source":["# from sklearn.ensemble import RandomForestClassifier\n","\n","# model1 = RandomForestClassifier(random_state=42, n_jobs=-1,max_depth= 6,\n","#  max_features='log2',\n","#  max_samples= 100,\n","#  min_samples_split= 6,\n","#  n_estimators= 162)\n","# model1.fit(x_train, y_train)\n","# y_pred = model1.predict(x_test)\n","# y_prob = model1.predict_proba(x_test)[:,1]\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":63,"status":"ok","timestamp":1766819785759,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"Z43sKUJH4lq2","outputId":"5ddc7984-8f01-49f2-a1cb-67d05546ec9e"},"outputs":[{"name":"stdout","output_type":"stream","text":["Accuracy: 0.8727272727272727\n","              precision    recall  f1-score   support\n","\n","           0       0.90      0.87      0.88        30\n","           1       0.85      0.88      0.86        25\n","\n","    accuracy                           0.87        55\n","   macro avg       0.87      0.87      0.87        55\n","weighted avg       0.87      0.87      0.87        55\n","\n","Confusion matrix:\n"," [[26  4]\n"," [ 3 22]]\n","ROC AUC: 0.9493333333333334\n","PR AUC (average precision): 0.9495357520987129\n"]}],"source":["from sklearn.metrics import classification_report, confusion_matrix, roc_auc_score, average_precision_score,accuracy_score\n","\n","print(\"Accuracy:\", accuracy_score(y_test, y_pred))\n","\n","print(classification_report(y_test, y_pred))\n","print(\"Confusion matrix:\\n\", confusion_matrix(y_test, y_pred))\n","print(\"ROC AUC:\", roc_auc_score(y_test, y_prob))\n","print(\"PR AUC (average precision):\", average_precision_score(y_test, y_prob))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":653,"status":"ok","timestamp":1766819786408,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"m3WqxiCf58B2","outputId":"9db48cf7-2eb8-4eaa-f649-f327d1fefec9"},"outputs":[{"name":"stdout","output_type":"stream","text":["Accuracy: 0.8545454545454545\n","              precision    recall  f1-score   support\n","\n","           0       0.89      0.83      0.86        30\n","           1       0.81      0.88      0.85        25\n","\n","    accuracy                           0.85        55\n","   macro avg       0.85      0.86      0.85        55\n","weighted avg       0.86      0.85      0.85        55\n","\n","Confusion matrix:\n"," [[25  5]\n"," [ 3 22]]\n","ROC AUC: 0.9493333333333334\n","PR AUC (average precision): 0.9506735019008077\n"]}],"source":["from sklearn.ensemble import RandomForestClassifier\n","\n","model1 = RandomForestClassifier(random_state=42, n_jobs=-1,max_depth= 6,\n"," max_features='log2',\n"," max_samples= 50,\n"," min_samples_split= 6,\n"," n_estimators= 289)\n","model1.fit(x_train_res, y_train_res)\n","y_pred = model1.predict(x_test)\n","y_prob = model1.predict_proba(x_test)[:,1]\n","\n","from sklearn.metrics import classification_report, confusion_matrix, roc_auc_score, average_precision_score,accuracy_score\n","\n","print(\"Accuracy:\", accuracy_score(y_test, y_pred))\n","\n","print(classification_report(y_test, y_pred))\n","print(\"Confusion matrix:\\n\", confusion_matrix(y_test, y_pred))\n","print(\"ROC AUC:\", roc_auc_score(y_test, y_prob))\n","print(\"PR AUC (average precision):\", average_precision_score(y_test, y_prob))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":182},"executionInfo":{"elapsed":18397,"status":"ok","timestamp":1766819804832,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"YSW8KrIS6BYY","outputId":"00421e6d-2a60-4b17-81ff-42648585f5b4"},"outputs":[{"name":"stdout","output_type":"stream","text":["Fitting 5 folds for each of 10 candidates, totalling 50 fits\n"]},{"data":{"text/html":["<style>#sk-container-id-1 {\n","  /* Definition of color scheme common for light and dark mode */\n","  --sklearn-color-text: #000;\n","  --sklearn-color-text-muted: #666;\n","  --sklearn-color-line: gray;\n","  /* Definition of color scheme for unfitted estimators */\n","  --sklearn-color-unfitted-level-0: #fff5e6;\n","  --sklearn-color-unfitted-level-1: #f6e4d2;\n","  --sklearn-color-unfitted-level-2: #ffe0b3;\n","  --sklearn-color-unfitted-level-3: chocolate;\n","  /* Definition of color scheme for fitted estimators */\n","  --sklearn-color-fitted-level-0: #f0f8ff;\n","  --sklearn-color-fitted-level-1: #d4ebff;\n","  --sklearn-color-fitted-level-2: #b3dbfd;\n","  --sklearn-color-fitted-level-3: cornflowerblue;\n","\n","  /* Specific color for light theme */\n","  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n","  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n","  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n","  --sklearn-color-icon: #696969;\n","\n","  @media (prefers-color-scheme: dark) {\n","    /* Redefinition of color scheme for dark theme */\n","    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n","    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n","    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n","    --sklearn-color-icon: #878787;\n","  }\n","}\n","\n","#sk-container-id-1 {\n","  color: var(--sklearn-color-text);\n","}\n","\n","#sk-container-id-1 pre {\n","  padding: 0;\n","}\n","\n","#sk-container-id-1 input.sk-hidden--visually {\n","  border: 0;\n","  clip: rect(1px 1px 1px 1px);\n","  clip: rect(1px, 1px, 1px, 1px);\n","  height: 1px;\n","  margin: -1px;\n","  overflow: hidden;\n","  padding: 0;\n","  position: absolute;\n","  width: 1px;\n","}\n","\n","#sk-container-id-1 div.sk-dashed-wrapped {\n","  border: 1px dashed var(--sklearn-color-line);\n","  margin: 0 0.4em 0.5em 0.4em;\n","  box-sizing: border-box;\n","  padding-bottom: 0.4em;\n","  background-color: var(--sklearn-color-background);\n","}\n","\n","#sk-container-id-1 div.sk-container {\n","  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n","     but bootstrap.min.css set `[hidden] { display: none !important; }`\n","     so we also need the `!important` here to be able to override the\n","     default hidden behavior on the sphinx rendered scikit-learn.org.\n","     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n","  display: inline-block !important;\n","  position: relative;\n","}\n","\n","#sk-container-id-1 div.sk-text-repr-fallback {\n","  display: none;\n","}\n","\n","div.sk-parallel-item,\n","div.sk-serial,\n","div.sk-item {\n","  /* draw centered vertical line to link estimators */\n","  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n","  background-size: 2px 100%;\n","  background-repeat: no-repeat;\n","  background-position: center center;\n","}\n","\n","/* Parallel-specific style estimator block */\n","\n","#sk-container-id-1 div.sk-parallel-item::after {\n","  content: \"\";\n","  width: 100%;\n","  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n","  flex-grow: 1;\n","}\n","\n","#sk-container-id-1 div.sk-parallel {\n","  display: flex;\n","  align-items: stretch;\n","  justify-content: center;\n","  background-color: var(--sklearn-color-background);\n","  position: relative;\n","}\n","\n","#sk-container-id-1 div.sk-parallel-item {\n","  display: flex;\n","  flex-direction: column;\n","}\n","\n","#sk-container-id-1 div.sk-parallel-item:first-child::after {\n","  align-self: flex-end;\n","  width: 50%;\n","}\n","\n","#sk-container-id-1 div.sk-parallel-item:last-child::after {\n","  align-self: flex-start;\n","  width: 50%;\n","}\n","\n","#sk-container-id-1 div.sk-parallel-item:only-child::after {\n","  width: 0;\n","}\n","\n","/* Serial-specific style estimator block */\n","\n","#sk-container-id-1 div.sk-serial {\n","  display: flex;\n","  flex-direction: column;\n","  align-items: center;\n","  background-color: var(--sklearn-color-background);\n","  padding-right: 1em;\n","  padding-left: 1em;\n","}\n","\n","\n","/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\n","clickable and can be expanded/collapsed.\n","- Pipeline and ColumnTransformer use this feature and define the default style\n","- Estimators will overwrite some part of the style using the `sk-estimator` class\n","*/\n","\n","/* Pipeline and ColumnTransformer style (default) */\n","\n","#sk-container-id-1 div.sk-toggleable {\n","  /* Default theme specific background. It is overwritten whether we have a\n","  specific estimator or a Pipeline/ColumnTransformer */\n","  background-color: var(--sklearn-color-background);\n","}\n","\n","/* Toggleable label */\n","#sk-container-id-1 label.sk-toggleable__label {\n","  cursor: pointer;\n","  display: flex;\n","  width: 100%;\n","  margin-bottom: 0;\n","  padding: 0.5em;\n","  box-sizing: border-box;\n","  text-align: center;\n","  align-items: start;\n","  justify-content: space-between;\n","  gap: 0.5em;\n","}\n","\n","#sk-container-id-1 label.sk-toggleable__label .caption {\n","  font-size: 0.6rem;\n","  font-weight: lighter;\n","  color: var(--sklearn-color-text-muted);\n","}\n","\n","#sk-container-id-1 label.sk-toggleable__label-arrow:before {\n","  /* Arrow on the left of the label */\n","  content: \"▸\";\n","  float: left;\n","  margin-right: 0.25em;\n","  color: var(--sklearn-color-icon);\n","}\n","\n","#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {\n","  color: var(--sklearn-color-text);\n","}\n","\n","/* Toggleable content - dropdown */\n","\n","#sk-container-id-1 div.sk-toggleable__content {\n","  max-height: 0;\n","  max-width: 0;\n","  overflow: hidden;\n","  text-align: left;\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-0);\n","}\n","\n","#sk-container-id-1 div.sk-toggleable__content.fitted {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-0);\n","}\n","\n","#sk-container-id-1 div.sk-toggleable__content pre {\n","  margin: 0.2em;\n","  border-radius: 0.25em;\n","  color: var(--sklearn-color-text);\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-0);\n","}\n","\n","#sk-container-id-1 div.sk-toggleable__content.fitted pre {\n","  /* unfitted */\n","  background-color: var(--sklearn-color-fitted-level-0);\n","}\n","\n","#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n","  /* Expand drop-down */\n","  max-height: 200px;\n","  max-width: 100%;\n","  overflow: auto;\n","}\n","\n","#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n","  content: \"▾\";\n","}\n","\n","/* Pipeline/ColumnTransformer-specific style */\n","\n","#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n","  color: var(--sklearn-color-text);\n","  background-color: var(--sklearn-color-unfitted-level-2);\n","}\n","\n","#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n","  background-color: var(--sklearn-color-fitted-level-2);\n","}\n","\n","/* Estimator-specific style */\n","\n","/* Colorize estimator box */\n","#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-2);\n","}\n","\n","#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-2);\n","}\n","\n","#sk-container-id-1 div.sk-label label.sk-toggleable__label,\n","#sk-container-id-1 div.sk-label label {\n","  /* The background is the default theme color */\n","  color: var(--sklearn-color-text-on-default-background);\n","}\n","\n","/* On hover, darken the color of the background */\n","#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {\n","  color: var(--sklearn-color-text);\n","  background-color: var(--sklearn-color-unfitted-level-2);\n","}\n","\n","/* Label box, darken color on hover, fitted */\n","#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n","  color: var(--sklearn-color-text);\n","  background-color: var(--sklearn-color-fitted-level-2);\n","}\n","\n","/* Estimator label */\n","\n","#sk-container-id-1 div.sk-label label {\n","  font-family: monospace;\n","  font-weight: bold;\n","  display: inline-block;\n","  line-height: 1.2em;\n","}\n","\n","#sk-container-id-1 div.sk-label-container {\n","  text-align: center;\n","}\n","\n","/* Estimator-specific */\n","#sk-container-id-1 div.sk-estimator {\n","  font-family: monospace;\n","  border: 1px dotted var(--sklearn-color-border-box);\n","  border-radius: 0.25em;\n","  box-sizing: border-box;\n","  margin-bottom: 0.5em;\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-0);\n","}\n","\n","#sk-container-id-1 div.sk-estimator.fitted {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-0);\n","}\n","\n","/* on hover */\n","#sk-container-id-1 div.sk-estimator:hover {\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-2);\n","}\n","\n","#sk-container-id-1 div.sk-estimator.fitted:hover {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-2);\n","}\n","\n","/* Specification for estimator info (e.g. \"i\" and \"?\") */\n","\n","/* Common style for \"i\" and \"?\" */\n","\n",".sk-estimator-doc-link,\n","a:link.sk-estimator-doc-link,\n","a:visited.sk-estimator-doc-link {\n","  float: right;\n","  font-size: smaller;\n","  line-height: 1em;\n","  font-family: monospace;\n","  background-color: var(--sklearn-color-background);\n","  border-radius: 1em;\n","  height: 1em;\n","  width: 1em;\n","  text-decoration: none !important;\n","  margin-left: 0.5em;\n","  text-align: center;\n","  /* unfitted */\n","  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n","  color: var(--sklearn-color-unfitted-level-1);\n","}\n","\n",".sk-estimator-doc-link.fitted,\n","a:link.sk-estimator-doc-link.fitted,\n","a:visited.sk-estimator-doc-link.fitted {\n","  /* fitted */\n","  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n","  color: var(--sklearn-color-fitted-level-1);\n","}\n","\n","/* On hover */\n","div.sk-estimator:hover .sk-estimator-doc-link:hover,\n",".sk-estimator-doc-link:hover,\n","div.sk-label-container:hover .sk-estimator-doc-link:hover,\n",".sk-estimator-doc-link:hover {\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-3);\n","  color: var(--sklearn-color-background);\n","  text-decoration: none;\n","}\n","\n","div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n",".sk-estimator-doc-link.fitted:hover,\n","div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n",".sk-estimator-doc-link.fitted:hover {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-3);\n","  color: var(--sklearn-color-background);\n","  text-decoration: none;\n","}\n","\n","/* Span, style for the box shown on hovering the info icon */\n",".sk-estimator-doc-link span {\n","  display: none;\n","  z-index: 9999;\n","  position: relative;\n","  font-weight: normal;\n","  right: .2ex;\n","  padding: .5ex;\n","  margin: .5ex;\n","  width: min-content;\n","  min-width: 20ex;\n","  max-width: 50ex;\n","  color: var(--sklearn-color-text);\n","  box-shadow: 2pt 2pt 4pt #999;\n","  /* unfitted */\n","  background: var(--sklearn-color-unfitted-level-0);\n","  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n","}\n","\n",".sk-estimator-doc-link.fitted span {\n","  /* fitted */\n","  background: var(--sklearn-color-fitted-level-0);\n","  border: var(--sklearn-color-fitted-level-3);\n","}\n","\n",".sk-estimator-doc-link:hover span {\n","  display: block;\n","}\n","\n","/* \"?\"-specific style due to the `<a>` HTML tag */\n","\n","#sk-container-id-1 a.estimator_doc_link {\n","  float: right;\n","  font-size: 1rem;\n","  line-height: 1em;\n","  font-family: monospace;\n","  background-color: var(--sklearn-color-background);\n","  border-radius: 1rem;\n","  height: 1rem;\n","  width: 1rem;\n","  text-decoration: none;\n","  /* unfitted */\n","  color: var(--sklearn-color-unfitted-level-1);\n","  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n","}\n","\n","#sk-container-id-1 a.estimator_doc_link.fitted {\n","  /* fitted */\n","  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n","  color: var(--sklearn-color-fitted-level-1);\n","}\n","\n","/* On hover */\n","#sk-container-id-1 a.estimator_doc_link:hover {\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-3);\n","  color: var(--sklearn-color-background);\n","  text-decoration: none;\n","}\n","\n","#sk-container-id-1 a.estimator_doc_link.fitted:hover {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-3);\n","}\n","</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>RandomizedSearchCV(cv=5, estimator=RandomForestClassifier(random_state=42),\n","                   n_jobs=-1,\n","                   param_distributions={&#x27;bootstrap&#x27;: [True, False],\n","                                        &#x27;max_depth&#x27;: [10, 20, 30, 40, None],\n","                                        &#x27;max_features&#x27;: [&#x27;sqrt&#x27;, &#x27;log2&#x27;, None],\n","                                        &#x27;min_samples_leaf&#x27;: [1, 2, 7, 12],\n","                                        &#x27;min_samples_split&#x27;: [2, 5, 10],\n","                                        &#x27;n_estimators&#x27;: [100, 200, 300, 400]},\n","                   random_state=42, verbose=5)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" ><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>RandomizedSearchCV</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.model_selection.RandomizedSearchCV.html\">?<span>Documentation for RandomizedSearchCV</span></a><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></div></label><div class=\"sk-toggleable__content fitted\"><pre>RandomizedSearchCV(cv=5, estimator=RandomForestClassifier(random_state=42),\n","                   n_jobs=-1,\n","                   param_distributions={&#x27;bootstrap&#x27;: [True, False],\n","                                        &#x27;max_depth&#x27;: [10, 20, 30, 40, None],\n","                                        &#x27;max_features&#x27;: [&#x27;sqrt&#x27;, &#x27;log2&#x27;, None],\n","                                        &#x27;min_samples_leaf&#x27;: [1, 2, 7, 12],\n","                                        &#x27;min_samples_split&#x27;: [2, 5, 10],\n","                                        &#x27;n_estimators&#x27;: [100, 200, 300, 400]},\n","                   random_state=42, verbose=5)</pre></div> </div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-2\" type=\"checkbox\" ><label for=\"sk-estimator-id-2\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>best_estimator_: RandomForestClassifier</div></div></label><div class=\"sk-toggleable__content fitted\"><pre>RandomForestClassifier(bootstrap=False, max_depth=30, max_features=None,\n","                       min_samples_leaf=2, min_samples_split=10,\n","                       n_estimators=300, random_state=42)</pre></div> </div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-3\" type=\"checkbox\" ><label for=\"sk-estimator-id-3\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>RandomForestClassifier</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.ensemble.RandomForestClassifier.html\">?<span>Documentation for RandomForestClassifier</span></a></div></label><div class=\"sk-toggleable__content fitted\"><pre>RandomForestClassifier(bootstrap=False, max_depth=30, max_features=None,\n","                       min_samples_leaf=2, min_samples_split=10,\n","                       n_estimators=300, random_state=42)</pre></div> </div></div></div></div></div></div></div></div></div>"],"text/plain":["RandomizedSearchCV(cv=5, estimator=RandomForestClassifier(random_state=42),\n","                   n_jobs=-1,\n","                   param_distributions={'bootstrap': [True, False],\n","                                        'max_depth': [10, 20, 30, 40, None],\n","                                        'max_features': ['sqrt', 'log2', None],\n","                                        'min_samples_leaf': [1, 2, 7, 12],\n","                                        'min_samples_split': [2, 5, 10],\n","                                        'n_estimators': [100, 200, 300, 400]},\n","                   random_state=42, verbose=5)"]},"execution_count":20,"metadata":{},"output_type":"execute_result"}],"source":["from sklearn.model_selection import RandomizedSearchCV\n","from sklearn.ensemble import RandomForestClassifier\n","\n","param_distributions = {\n","    'bootstrap': [True, False],\n","    'max_depth': [10, 20, 30, 40, None],\n","    'max_features': ['sqrt', 'log2', None],\n","    'min_samples_leaf': [1, 2, 7, 12],\n","    'min_samples_split': [2, 5, 10],\n","    'n_estimators': [100,200,300,400]\n","}\n","\n","rf_random = RandomizedSearchCV(\n","    estimator=RandomForestClassifier(random_state=42),\n","    param_distributions=param_distributions,\n","\n","    cv=5,\n","    verbose=5,\n","    random_state=42,\n","    n_jobs=-1,\n","    refit=True\n",")\n","\n","rf_random.fit(x_train_res, y_train_res)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":115},"executionInfo":{"elapsed":52,"status":"ok","timestamp":1766819804834,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"ZDIMOsOcefD_","outputId":"f9ed7024-d8cc-4189-b03a-5b4c5eb01c1a"},"outputs":[{"data":{"text/html":["<style>#sk-container-id-2 {\n","  /* Definition of color scheme common for light and dark mode */\n","  --sklearn-color-text: #000;\n","  --sklearn-color-text-muted: #666;\n","  --sklearn-color-line: gray;\n","  /* Definition of color scheme for unfitted estimators */\n","  --sklearn-color-unfitted-level-0: #fff5e6;\n","  --sklearn-color-unfitted-level-1: #f6e4d2;\n","  --sklearn-color-unfitted-level-2: #ffe0b3;\n","  --sklearn-color-unfitted-level-3: chocolate;\n","  /* Definition of color scheme for fitted estimators */\n","  --sklearn-color-fitted-level-0: #f0f8ff;\n","  --sklearn-color-fitted-level-1: #d4ebff;\n","  --sklearn-color-fitted-level-2: #b3dbfd;\n","  --sklearn-color-fitted-level-3: cornflowerblue;\n","\n","  /* Specific color for light theme */\n","  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n","  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n","  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n","  --sklearn-color-icon: #696969;\n","\n","  @media (prefers-color-scheme: dark) {\n","    /* Redefinition of color scheme for dark theme */\n","    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n","    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n","    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n","    --sklearn-color-icon: #878787;\n","  }\n","}\n","\n","#sk-container-id-2 {\n","  color: var(--sklearn-color-text);\n","}\n","\n","#sk-container-id-2 pre {\n","  padding: 0;\n","}\n","\n","#sk-container-id-2 input.sk-hidden--visually {\n","  border: 0;\n","  clip: rect(1px 1px 1px 1px);\n","  clip: rect(1px, 1px, 1px, 1px);\n","  height: 1px;\n","  margin: -1px;\n","  overflow: hidden;\n","  padding: 0;\n","  position: absolute;\n","  width: 1px;\n","}\n","\n","#sk-container-id-2 div.sk-dashed-wrapped {\n","  border: 1px dashed var(--sklearn-color-line);\n","  margin: 0 0.4em 0.5em 0.4em;\n","  box-sizing: border-box;\n","  padding-bottom: 0.4em;\n","  background-color: var(--sklearn-color-background);\n","}\n","\n","#sk-container-id-2 div.sk-container {\n","  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n","     but bootstrap.min.css set `[hidden] { display: none !important; }`\n","     so we also need the `!important` here to be able to override the\n","     default hidden behavior on the sphinx rendered scikit-learn.org.\n","     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n","  display: inline-block !important;\n","  position: relative;\n","}\n","\n","#sk-container-id-2 div.sk-text-repr-fallback {\n","  display: none;\n","}\n","\n","div.sk-parallel-item,\n","div.sk-serial,\n","div.sk-item {\n","  /* draw centered vertical line to link estimators */\n","  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n","  background-size: 2px 100%;\n","  background-repeat: no-repeat;\n","  background-position: center center;\n","}\n","\n","/* Parallel-specific style estimator block */\n","\n","#sk-container-id-2 div.sk-parallel-item::after {\n","  content: \"\";\n","  width: 100%;\n","  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n","  flex-grow: 1;\n","}\n","\n","#sk-container-id-2 div.sk-parallel {\n","  display: flex;\n","  align-items: stretch;\n","  justify-content: center;\n","  background-color: var(--sklearn-color-background);\n","  position: relative;\n","}\n","\n","#sk-container-id-2 div.sk-parallel-item {\n","  display: flex;\n","  flex-direction: column;\n","}\n","\n","#sk-container-id-2 div.sk-parallel-item:first-child::after {\n","  align-self: flex-end;\n","  width: 50%;\n","}\n","\n","#sk-container-id-2 div.sk-parallel-item:last-child::after {\n","  align-self: flex-start;\n","  width: 50%;\n","}\n","\n","#sk-container-id-2 div.sk-parallel-item:only-child::after {\n","  width: 0;\n","}\n","\n","/* Serial-specific style estimator block */\n","\n","#sk-container-id-2 div.sk-serial {\n","  display: flex;\n","  flex-direction: column;\n","  align-items: center;\n","  background-color: var(--sklearn-color-background);\n","  padding-right: 1em;\n","  padding-left: 1em;\n","}\n","\n","\n","/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\n","clickable and can be expanded/collapsed.\n","- Pipeline and ColumnTransformer use this feature and define the default style\n","- Estimators will overwrite some part of the style using the `sk-estimator` class\n","*/\n","\n","/* Pipeline and ColumnTransformer style (default) */\n","\n","#sk-container-id-2 div.sk-toggleable {\n","  /* Default theme specific background. It is overwritten whether we have a\n","  specific estimator or a Pipeline/ColumnTransformer */\n","  background-color: var(--sklearn-color-background);\n","}\n","\n","/* Toggleable label */\n","#sk-container-id-2 label.sk-toggleable__label {\n","  cursor: pointer;\n","  display: flex;\n","  width: 100%;\n","  margin-bottom: 0;\n","  padding: 0.5em;\n","  box-sizing: border-box;\n","  text-align: center;\n","  align-items: start;\n","  justify-content: space-between;\n","  gap: 0.5em;\n","}\n","\n","#sk-container-id-2 label.sk-toggleable__label .caption {\n","  font-size: 0.6rem;\n","  font-weight: lighter;\n","  color: var(--sklearn-color-text-muted);\n","}\n","\n","#sk-container-id-2 label.sk-toggleable__label-arrow:before {\n","  /* Arrow on the left of the label */\n","  content: \"▸\";\n","  float: left;\n","  margin-right: 0.25em;\n","  color: var(--sklearn-color-icon);\n","}\n","\n","#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {\n","  color: var(--sklearn-color-text);\n","}\n","\n","/* Toggleable content - dropdown */\n","\n","#sk-container-id-2 div.sk-toggleable__content {\n","  max-height: 0;\n","  max-width: 0;\n","  overflow: hidden;\n","  text-align: left;\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-0);\n","}\n","\n","#sk-container-id-2 div.sk-toggleable__content.fitted {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-0);\n","}\n","\n","#sk-container-id-2 div.sk-toggleable__content pre {\n","  margin: 0.2em;\n","  border-radius: 0.25em;\n","  color: var(--sklearn-color-text);\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-0);\n","}\n","\n","#sk-container-id-2 div.sk-toggleable__content.fitted pre {\n","  /* unfitted */\n","  background-color: var(--sklearn-color-fitted-level-0);\n","}\n","\n","#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n","  /* Expand drop-down */\n","  max-height: 200px;\n","  max-width: 100%;\n","  overflow: auto;\n","}\n","\n","#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n","  content: \"▾\";\n","}\n","\n","/* Pipeline/ColumnTransformer-specific style */\n","\n","#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n","  color: var(--sklearn-color-text);\n","  background-color: var(--sklearn-color-unfitted-level-2);\n","}\n","\n","#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n","  background-color: var(--sklearn-color-fitted-level-2);\n","}\n","\n","/* Estimator-specific style */\n","\n","/* Colorize estimator box */\n","#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-2);\n","}\n","\n","#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-2);\n","}\n","\n","#sk-container-id-2 div.sk-label label.sk-toggleable__label,\n","#sk-container-id-2 div.sk-label label {\n","  /* The background is the default theme color */\n","  color: var(--sklearn-color-text-on-default-background);\n","}\n","\n","/* On hover, darken the color of the background */\n","#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {\n","  color: var(--sklearn-color-text);\n","  background-color: var(--sklearn-color-unfitted-level-2);\n","}\n","\n","/* Label box, darken color on hover, fitted */\n","#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n","  color: var(--sklearn-color-text);\n","  background-color: var(--sklearn-color-fitted-level-2);\n","}\n","\n","/* Estimator label */\n","\n","#sk-container-id-2 div.sk-label label {\n","  font-family: monospace;\n","  font-weight: bold;\n","  display: inline-block;\n","  line-height: 1.2em;\n","}\n","\n","#sk-container-id-2 div.sk-label-container {\n","  text-align: center;\n","}\n","\n","/* Estimator-specific */\n","#sk-container-id-2 div.sk-estimator {\n","  font-family: monospace;\n","  border: 1px dotted var(--sklearn-color-border-box);\n","  border-radius: 0.25em;\n","  box-sizing: border-box;\n","  margin-bottom: 0.5em;\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-0);\n","}\n","\n","#sk-container-id-2 div.sk-estimator.fitted {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-0);\n","}\n","\n","/* on hover */\n","#sk-container-id-2 div.sk-estimator:hover {\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-2);\n","}\n","\n","#sk-container-id-2 div.sk-estimator.fitted:hover {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-2);\n","}\n","\n","/* Specification for estimator info (e.g. \"i\" and \"?\") */\n","\n","/* Common style for \"i\" and \"?\" */\n","\n",".sk-estimator-doc-link,\n","a:link.sk-estimator-doc-link,\n","a:visited.sk-estimator-doc-link {\n","  float: right;\n","  font-size: smaller;\n","  line-height: 1em;\n","  font-family: monospace;\n","  background-color: var(--sklearn-color-background);\n","  border-radius: 1em;\n","  height: 1em;\n","  width: 1em;\n","  text-decoration: none !important;\n","  margin-left: 0.5em;\n","  text-align: center;\n","  /* unfitted */\n","  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n","  color: var(--sklearn-color-unfitted-level-1);\n","}\n","\n",".sk-estimator-doc-link.fitted,\n","a:link.sk-estimator-doc-link.fitted,\n","a:visited.sk-estimator-doc-link.fitted {\n","  /* fitted */\n","  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n","  color: var(--sklearn-color-fitted-level-1);\n","}\n","\n","/* On hover */\n","div.sk-estimator:hover .sk-estimator-doc-link:hover,\n",".sk-estimator-doc-link:hover,\n","div.sk-label-container:hover .sk-estimator-doc-link:hover,\n",".sk-estimator-doc-link:hover {\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-3);\n","  color: var(--sklearn-color-background);\n","  text-decoration: none;\n","}\n","\n","div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n",".sk-estimator-doc-link.fitted:hover,\n","div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n",".sk-estimator-doc-link.fitted:hover {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-3);\n","  color: var(--sklearn-color-background);\n","  text-decoration: none;\n","}\n","\n","/* Span, style for the box shown on hovering the info icon */\n",".sk-estimator-doc-link span {\n","  display: none;\n","  z-index: 9999;\n","  position: relative;\n","  font-weight: normal;\n","  right: .2ex;\n","  padding: .5ex;\n","  margin: .5ex;\n","  width: min-content;\n","  min-width: 20ex;\n","  max-width: 50ex;\n","  color: var(--sklearn-color-text);\n","  box-shadow: 2pt 2pt 4pt #999;\n","  /* unfitted */\n","  background: var(--sklearn-color-unfitted-level-0);\n","  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n","}\n","\n",".sk-estimator-doc-link.fitted span {\n","  /* fitted */\n","  background: var(--sklearn-color-fitted-level-0);\n","  border: var(--sklearn-color-fitted-level-3);\n","}\n","\n",".sk-estimator-doc-link:hover span {\n","  display: block;\n","}\n","\n","/* \"?\"-specific style due to the `<a>` HTML tag */\n","\n","#sk-container-id-2 a.estimator_doc_link {\n","  float: right;\n","  font-size: 1rem;\n","  line-height: 1em;\n","  font-family: monospace;\n","  background-color: var(--sklearn-color-background);\n","  border-radius: 1rem;\n","  height: 1rem;\n","  width: 1rem;\n","  text-decoration: none;\n","  /* unfitted */\n","  color: var(--sklearn-color-unfitted-level-1);\n","  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n","}\n","\n","#sk-container-id-2 a.estimator_doc_link.fitted {\n","  /* fitted */\n","  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n","  color: var(--sklearn-color-fitted-level-1);\n","}\n","\n","/* On hover */\n","#sk-container-id-2 a.estimator_doc_link:hover {\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-3);\n","  color: var(--sklearn-color-background);\n","  text-decoration: none;\n","}\n","\n","#sk-container-id-2 a.estimator_doc_link.fitted:hover {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-3);\n","}\n","</style><div id=\"sk-container-id-2\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>RandomForestClassifier(bootstrap=False, max_depth=30, max_features=None,\n","                       min_samples_leaf=2, min_samples_split=10,\n","                       n_estimators=300, random_state=42)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator fitted sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-4\" type=\"checkbox\" checked><label for=\"sk-estimator-id-4\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow\"><div><div>RandomForestClassifier</div></div><div><a class=\"sk-estimator-doc-link fitted\" rel=\"noreferrer\" target=\"_blank\" href=\"https://scikit-learn.org/1.6/modules/generated/sklearn.ensemble.RandomForestClassifier.html\">?<span>Documentation for RandomForestClassifier</span></a><span class=\"sk-estimator-doc-link fitted\">i<span>Fitted</span></span></div></label><div class=\"sk-toggleable__content fitted\"><pre>RandomForestClassifier(bootstrap=False, max_depth=30, max_features=None,\n","                       min_samples_leaf=2, min_samples_split=10,\n","                       n_estimators=300, random_state=42)</pre></div> </div></div></div></div>"],"text/plain":["RandomForestClassifier(bootstrap=False, max_depth=30, max_features=None,\n","                       min_samples_leaf=2, min_samples_split=10,\n","                       n_estimators=300, random_state=42)"]},"execution_count":21,"metadata":{},"output_type":"execute_result"}],"source":["rf_random.best_estimator_"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"8CCjJ6uUk7JK"},"outputs":[],"source":["y_pred=rf_random.predict(x_test)\n","y_prob=rf_random.predict_proba(x_test)[:,1]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":36,"status":"ok","timestamp":1766819804899,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"0faeaupQmT4D","outputId":"26d538e5-ee40-4222-f20e-4fa609137475"},"outputs":[{"name":"stdout","output_type":"stream","text":["Accuracy: 0.8181818181818182\n","              precision    recall  f1-score   support\n","\n","           0       0.83      0.83      0.83        30\n","           1       0.80      0.80      0.80        25\n","\n","    accuracy                           0.82        55\n","   macro avg       0.82      0.82      0.82        55\n","weighted avg       0.82      0.82      0.82        55\n","\n","Confusion matrix:\n"," [[25  5]\n"," [ 5 20]]\n","ROC AUC: 0.9113333333333332\n","PR AUC (average precision): 0.9097059883850165\n"]}],"source":["from sklearn.metrics import classification_report, confusion_matrix, roc_auc_score, average_precision_score,accuracy_score\n","print(\"Accuracy:\", accuracy_score(y_test, y_pred))\n","\n","print(classification_report(y_test, y_pred))\n","print(\"Confusion matrix:\\n\", confusion_matrix(y_test, y_pred))\n","print(\"ROC AUC:\", roc_auc_score(y_test, y_prob))\n","print(\"PR AUC (average precision):\", average_precision_score(y_test, y_prob))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"5zzYbhVQnU-I"},"outputs":[],"source":["# from sklearn.model_selection import cross_val_score\n","# scores = cross_val_score(rf_random, x_train, y_train, cv=5)\n","# scores"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qMxWaDuRnusX"},"outputs":[],"source":["# scores.mean()"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"6AGHMEFWoald"},"outputs":[],"source":["# scores.std()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5142,"status":"ok","timestamp":1766819810053,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"tPWpoJcfshkb","outputId":"bdd59e34-7668-4c20-e0bd-ed271a63cf82"},"outputs":[{"name":"stdout","output_type":"stream","text":["Collecting scikit-optimize\n","  Downloading scikit_optimize-0.10.2-py2.py3-none-any.whl.metadata (9.7 kB)\n","Requirement already satisfied: joblib>=0.11 in /usr/local/lib/python3.12/dist-packages (from scikit-optimize) (1.5.3)\n","Collecting pyaml>=16.9 (from scikit-optimize)\n","  Downloading pyaml-25.7.0-py3-none-any.whl.metadata (12 kB)\n","Requirement already satisfied: numpy>=1.20.3 in /usr/local/lib/python3.12/dist-packages (from scikit-optimize) (2.0.2)\n","Requirement already satisfied: scipy>=1.1.0 in /usr/local/lib/python3.12/dist-packages (from scikit-optimize) (1.16.3)\n","Requirement already satisfied: scikit-learn>=1.0.0 in /usr/local/lib/python3.12/dist-packages (from scikit-optimize) (1.6.1)\n","Requirement already satisfied: packaging>=21.3 in /usr/local/lib/python3.12/dist-packages (from scikit-optimize) (25.0)\n","Requirement already satisfied: PyYAML in /usr/local/lib/python3.12/dist-packages (from pyaml>=16.9->scikit-optimize) (6.0.3)\n","Requirement already satisfied: threadpoolctl>=3.1.0 in /usr/local/lib/python3.12/dist-packages (from scikit-learn>=1.0.0->scikit-optimize) (3.6.0)\n","Downloading scikit_optimize-0.10.2-py2.py3-none-any.whl (107 kB)\n","\u001b[?25l   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/107.8 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m107.8/107.8 kB\u001b[0m \u001b[31m6.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading pyaml-25.7.0-py3-none-any.whl (26 kB)\n","Installing collected packages: pyaml, scikit-optimize\n","Successfully installed pyaml-25.7.0 scikit-optimize-0.10.2\n"]}],"source":["!pip install scikit-optimize"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"EYn8g7KmtdDo"},"outputs":[],"source":["from skopt import BayesSearchCV\n","from sklearn.ensemble import RandomForestClassifier\n","\n","# Define search space\n","param_space = {\n","    'bootstrap': [True, False],\n","    'max_depth': [10, 20, 30, 40, None],\n","    'max_features': ['sqrt', 'log2', None],\n","    'min_samples_leaf': [1, 2, 7, 12],\n","    'min_samples_split': [2, 5, 10],\n","    'n_estimators': [100, 200, 300, 400]\n","}\n","\n","\n","opt = BayesSearchCV(\n","    estimator=RandomForestClassifier(random_state=42),\n","    search_spaces=param_space,\n","    cv=5,          # cross-validation\n","    n_jobs=-1,     # all cores\n","    n_iter=50,     # number of iterations for Bayesian optimization (recommended)\n","    random_state=42,\n","    verbose=0,\n","    refit=True\n",")\n","\n","# Fit on training data\n","opt.fit(x_train_res, y_train_res)\n","\n","# Predictions\n","y_pred = opt.predict(x_test)\n","y_prob = opt.predict_proba(x_test)[:, 1]\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":34,"status":"ok","timestamp":1766820001898,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"k8myQ-j7tdnh","outputId":"13bfdda3-cb72-4dd1-871a-746aaa772c82"},"outputs":[{"name":"stdout","output_type":"stream","text":["Accuracy: 0.8909090909090909\n","              precision    recall  f1-score   support\n","\n","           0       0.93      0.87      0.90        30\n","           1       0.85      0.92      0.88        25\n","\n","    accuracy                           0.89        55\n","   macro avg       0.89      0.89      0.89        55\n","weighted avg       0.89      0.89      0.89        55\n","\n","Confusion matrix:\n"," [[26  4]\n"," [ 2 23]]\n","ROC AUC: 0.9586666666666667\n","PR AUC (average precision): 0.9676135920816772\n"]}],"source":["print(\"Accuracy:\", accuracy_score(y_test, y_pred))\n","\n","print(classification_report(y_test, y_pred))\n","print(\"Confusion matrix:\\n\", confusion_matrix(y_test, y_pred))\n","print(\"ROC AUC:\", roc_auc_score(y_test, y_prob))\n","print(\"PR AUC (average precision):\", average_precision_score(y_test, y_prob))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QtwR4kWQoVrr"},"outputs":[],"source":["# !pip install zoofs"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":192349,"status":"ok","timestamp":1766825433836,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"KaGq8Y8aRf6i","outputId":"7e78fd15-ca01-41e9-debb-f82309560f8c"},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: zoofs in /usr/local/lib/python3.12/dist-packages (0.1.26)\n","Requirement already satisfied: pandas>=1.3.0 in /usr/local/lib/python3.12/dist-packages (from zoofs) (2.2.2)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.12/dist-packages (from zoofs) (2.0.2)\n","Requirement already satisfied: scipy>=1.4.1 in /usr/local/lib/python3.12/dist-packages (from zoofs) (1.16.3)\n","Requirement already satisfied: plotly>=5.6.0 in /usr/local/lib/python3.12/dist-packages (from zoofs) (5.24.1)\n","Requirement already satisfied: colorlog>=6.6.0 in /usr/local/lib/python3.12/dist-packages (from zoofs) (6.10.1)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.12/dist-packages (from pandas>=1.3.0->zoofs) (2.9.0.post0)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.12/dist-packages (from pandas>=1.3.0->zoofs) (2025.2)\n","Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.12/dist-packages (from pandas>=1.3.0->zoofs) (2025.3)\n","Requirement already satisfied: tenacity>=6.2.0 in /usr/local/lib/python3.12/dist-packages (from plotly>=5.6.0->zoofs) (9.1.2)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.12/dist-packages (from plotly>=5.6.0->zoofs) (25.0)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.12/dist-packages (from python-dateutil>=2.8.2->pandas>=1.3.0->zoofs) (1.17.0)\n"]},{"output_type":"stream","name":"stderr","text":["\u001b[32m [ 2025-12-27 08:48:00,871 ] \u001b[0mFinished iteration #0 with objective value 0.4421033534876694. Current best value is 0.4421033534876694 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:48:31,370 ] \u001b[0mFinished iteration #1 with objective value 0.4295922918522409. Current best value is 0.4295922918522409 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:49:02,940 ] \u001b[0mFinished iteration #2 with objective value 0.42047459792074965. Current best value is 0.42047459792074965 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:49:27,851 ] \u001b[0mFinished iteration #3 with objective value 0.416890689713853. Current best value is 0.416890689713853 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:49:41,896 ] \u001b[0mFinished iteration #4 with objective value 0.42135511587359675. Current best value is 0.416890689713853 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:49:56,734 ] \u001b[0mFinished iteration #5 with objective value 0.4216914497691599. Current best value is 0.416890689713853 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:01,060 ] \u001b[0mFinished iteration #6 with objective value 0.416890689713853. Current best value is 0.416890689713853 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:05,260 ] \u001b[0mFinished iteration #7 with objective value 0.4188970224131875. Current best value is 0.416890689713853 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:07,287 ] \u001b[0mFinished iteration #8 with objective value 0.4188970224131875. Current best value is 0.416890689713853 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:08,772 ] \u001b[0mFinished iteration #9 with objective value 0.4188970224131875. Current best value is 0.416890689713853 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:12,520 ] \u001b[0mFinished iteration #10 with objective value 0.420897268082861. Current best value is 0.416890689713853 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:15,421 ] \u001b[0mFinished iteration #11 with objective value 0.4183471790623816. Current best value is 0.416890689713853 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:16,927 ] \u001b[0mFinished iteration #12 with objective value 0.4188970224131875. Current best value is 0.416890689713853 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:21,640 ] \u001b[0mFinished iteration #13 with objective value 0.41647575796201064. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:22,429 ] \u001b[0mFinished iteration #14 with objective value 0.4188970224131875. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:24,608 ] \u001b[0mFinished iteration #15 with objective value 0.4183471790623816. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:24,661 ] \u001b[0mFinished iteration #16 with objective value 0.4188970224131875. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:25,435 ] \u001b[0mFinished iteration #17 with objective value 0.416890689713853. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:26,188 ] \u001b[0mFinished iteration #18 with objective value 0.41647575796201064. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:27,716 ] \u001b[0mFinished iteration #19 with objective value 0.41647575796201064. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:27,774 ] \u001b[0mFinished iteration #20 with objective value 0.41647575796201064. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:27,830 ] \u001b[0mFinished iteration #21 with objective value 0.41647575796201064. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:28,600 ] \u001b[0mFinished iteration #22 with objective value 0.4188970224131875. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:28,654 ] \u001b[0mFinished iteration #23 with objective value 0.416890689713853. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:28,720 ] \u001b[0mFinished iteration #24 with objective value 0.4195567669219516. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:28,777 ] \u001b[0mFinished iteration #25 with objective value 0.41647575796201064. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:28,833 ] \u001b[0mFinished iteration #26 with objective value 0.4183471790623816. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:28,892 ] \u001b[0mFinished iteration #27 with objective value 0.41647575796201064. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:28,953 ] \u001b[0mFinished iteration #28 with objective value 0.41647575796201064. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:29,030 ] \u001b[0mFinished iteration #29 with objective value 0.41647575796201064. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:29,086 ] \u001b[0mFinished iteration #30 with objective value 0.4183471790623816. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:29,154 ] \u001b[0mFinished iteration #31 with objective value 0.416890689713853. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:29,240 ] \u001b[0mFinished iteration #32 with objective value 0.416890689713853. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:29,313 ] \u001b[0mFinished iteration #33 with objective value 0.4195567669219516. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:29,381 ] \u001b[0mFinished iteration #34 with objective value 0.4188970224131875. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:29,451 ] \u001b[0mFinished iteration #35 with objective value 0.41647575796201064. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:29,508 ] \u001b[0mFinished iteration #36 with objective value 0.4231230100419262. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:29,565 ] \u001b[0mFinished iteration #37 with objective value 0.416890689713853. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:29,619 ] \u001b[0mFinished iteration #38 with objective value 0.4188970224131875. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:29,677 ] \u001b[0mFinished iteration #39 with objective value 0.4188970224131875. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:29,734 ] \u001b[0mFinished iteration #40 with objective value 0.4183471790623816. Current best value is 0.41647575796201064 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:31,751 ] \u001b[0mFinished iteration #41 with objective value 0.4152944897564982. Current best value is 0.4152944897564982 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:32,938 ] \u001b[0mFinished iteration #42 with objective value 0.4152944897564982. Current best value is 0.4152944897564982 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:33,028 ] \u001b[0mFinished iteration #43 with objective value 0.4188970224131875. Current best value is 0.4152944897564982 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:33,116 ] \u001b[0mFinished iteration #44 with objective value 0.416890689713853. Current best value is 0.4152944897564982 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:33,179 ] \u001b[0mFinished iteration #45 with objective value 0.4188970224131875. Current best value is 0.4152944897564982 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:33,234 ] \u001b[0mFinished iteration #46 with objective value 0.4183471790623816. Current best value is 0.4152944897564982 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:33,294 ] \u001b[0mFinished iteration #47 with objective value 0.41647575796201064. Current best value is 0.4152944897564982 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:33,376 ] \u001b[0mFinished iteration #48 with objective value 0.416890689713853. Current best value is 0.4152944897564982 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:50:33,441 ] \u001b[0mFinished iteration #49 with objective value 0.416890689713853. Current best value is 0.4152944897564982 \u001b[0m\n"]}],"source":["!pip install zoofs\n","from sklearn.model_selection import StratifiedKFold, cross_val_score\n","from sklearn.base import clone\n","from sklearn.ensemble import RandomForestClassifier\n","import numpy as np\n","\n","def objective_function_topass(model, x_train_res, y_train_res, x_valid=None, y_valid=None):\n","\n","    cv = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)\n","\n","    scores = cross_val_score(\n","        clone(model),\n","        x_train_res,\n","        y_train_res,\n","        cv=cv,\n","        scoring=\"neg_log_loss\",\n","        n_jobs=-1\n","    )\n","\n","    return -np.mean(scores)\n","from zoofs import GreyWolfOptimization\n","\n","# Define base_model before it's used\n","base_model = RandomForestClassifier(random_state=42)\n","\n","algo_object = GreyWolfOptimization(\n","    objective_function_topass,\n","    n_iteration=50,\n","    population_size=40,\n","    minimize=True\n",")\n","\n","algo_object.fit(\n","    base_model,\n","    x_train_res,\n","    y_train_res,\n","    x_train_res,   # dummy\n","    y_train_res,   # dummy\n","    verbose=True\n",")\n","\n","best_features = algo_object.best_feature_list\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":27,"status":"ok","timestamp":1766825444582,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"UMBTW0pTVk1W","outputId":"55e10ff0-c43c-4631-a0cb-e4073dbd1fa0"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["38"]},"metadata":{},"execution_count":55}],"source":["len(best_features)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YscaZuzWVogP"},"outputs":[],"source":["opt.fit(x_train_res[best_features], y_train_res)\n","y_pred = opt.predict(x_test[best_features])\n","y_prob = opt.predict_proba(x_test[best_features])[:, 1]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16,"status":"ok","timestamp":1766825659728,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"ypKF2Bfkx1nW","outputId":"63473e24-3137-4b82-a0ed-2e9be297c3f2"},"outputs":[{"output_type":"stream","name":"stdout","text":["Accuracy: 0.9090909090909091\n","              precision    recall  f1-score   support\n","\n","           0       0.93      0.90      0.92        30\n","           1       0.88      0.92      0.90        25\n","\n","    accuracy                           0.91        55\n","   macro avg       0.91      0.91      0.91        55\n","weighted avg       0.91      0.91      0.91        55\n","\n","Confusion matrix:\n"," [[27  3]\n"," [ 2 23]]\n","ROC AUC: 0.9746666666666667\n","PR AUC (average precision): 0.9749175645943264\n"]}],"source":["print(\"Accuracy:\", accuracy_score(y_test, y_pred))\n","\n","print(classification_report(y_test, y_pred))\n","print(\"Confusion matrix:\\n\", confusion_matrix(y_test, y_pred))\n","print(\"ROC AUC:\", roc_auc_score(y_test, y_prob))\n","print(\"PR AUC (average precision):\", average_precision_score(y_test, y_prob))"]},{"cell_type":"code","source":["best_features"],"metadata":{"id":"uwx2soxhBEtQ","executionInfo":{"status":"ok","timestamp":1766825690392,"user_tz":-330,"elapsed":98,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"}},"outputId":"f87153f4-28df-4936-d2c2-528b52aef19c","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[np.str_('cat__Varicella_1'),\n"," np.str_('cat__Varicella_3'),\n"," np.str_('cat__Mono or polysymptomatic_1'),\n"," np.str_('cat__Mono or polysymptomatic_2'),\n"," np.str_('cat__Mono or polysymptomatic_3'),\n"," np.str_('cat__Oligoclonal bands_0'),\n"," np.str_('cat__Oligoclonal bands_1'),\n"," np.str_('cat__Oligoclonal bands_2'),\n"," np.str_('cat__initial EDSS_1.0'),\n"," np.str_('cat__initial EDSS_2.0'),\n"," np.str_('cat__initial EDSS_3.0'),\n"," np.str_('cat__initial symptom_1.0'),\n"," np.str_('cat__initial symptom_2.0'),\n"," np.str_('cat__initial symptom_3.0'),\n"," np.str_('cat__initial symptom_4.0'),\n"," np.str_('cat__initial symptom_5.0'),\n"," np.str_('cat__initial symptom_6.0'),\n"," np.str_('cat__initial symptom_7.0'),\n"," np.str_('cat__initial symptom_8.0'),\n"," np.str_('cat__initial symptom_9.0'),\n"," np.str_('cat__initial symptom_10.0'),\n"," np.str_('cat__initial symptom_11.0'),\n"," np.str_('cat__initial symptom_12.0'),\n"," np.str_('cat__initial symptom_13.0'),\n"," np.str_('cat__initial symptom_14.0'),\n"," np.str_('cat__initial symptom_15.0'),\n"," np.str_('cat__initial symptom_nan'),\n"," np.str_('cat__ final EDSS_1.0'),\n"," np.str_('cat__ final EDSS_2.0'),\n"," np.str_('cat__ final EDSS_3.0'),\n"," np.str_('remainder__Gender'),\n"," np.str_('remainder__Age (y)'),\n"," np.str_('remainder__LLSSEP'),\n"," np.str_('remainder__ULSSEP'),\n"," np.str_('remainder__BAEP'),\n"," np.str_('remainder__Periventricular MRI'),\n"," np.str_('remainder__Cortical MRI'),\n"," np.str_('remainder__Infratentorial MRI')]"]},"metadata":{},"execution_count":58}]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":466167,"status":"ok","timestamp":1766822168639,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"RPqUIJQKx46r","outputId":"a742ae15-341a-43f9-d865-e1635aafca34"},"outputs":[{"name":"stderr","output_type":"stream","text":["\u001b[32m [ 2025-12-27 07:48:55,353 ] \u001b[0mFinished iteration #0 with objective value 0.5005136959308089. Current best value is 0.434018614857634 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:49:15,719 ] \u001b[0mFinished iteration #1 with objective value 0.434018614857634. Current best value is 0.4324981228135318 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:49:37,165 ] \u001b[0mFinished iteration #2 with objective value 0.4153680594453024. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:49:58,128 ] \u001b[0mFinished iteration #3 with objective value 0.4373675242551111. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:50:16,005 ] \u001b[0mFinished iteration #4 with objective value 0.43182185172874377. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:50:58,349 ] \u001b[0mFinished iteration #5 with objective value 0.43543443813644345. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:51:14,740 ] \u001b[0mFinished iteration #6 with objective value 0.4203773385737509. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:51:41,367 ] \u001b[0mFinished iteration #7 with objective value 0.46293380431153. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:52:03,000 ] \u001b[0mFinished iteration #8 with objective value 0.42634725918313976. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:52:24,738 ] \u001b[0mFinished iteration #9 with objective value 0.42634725918313976. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:52:47,253 ] \u001b[0mFinished iteration #10 with objective value 0.4305154381913444. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:53:10,884 ] \u001b[0mFinished iteration #11 with objective value 0.43734555608489584. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:53:32,319 ] \u001b[0mFinished iteration #12 with objective value 0.44486172332394913. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:53:55,172 ] \u001b[0mFinished iteration #13 with objective value 0.4501997548678265. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:54:19,803 ] \u001b[0mFinished iteration #14 with objective value 0.44918312284193196. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:54:39,381 ] \u001b[0mFinished iteration #15 with objective value 0.4390776514505627. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:55:08,028 ] \u001b[0mFinished iteration #16 with objective value 0.43625042380138607. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:55:25,139 ] \u001b[0mFinished iteration #17 with objective value 0.43826181230176803. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:55:46,927 ] \u001b[0mFinished iteration #18 with objective value 0.44121771505252727. Current best value is 0.4153680594453024 \u001b[0m\n","\u001b[32m [ 2025-12-27 07:56:08,780 ] \u001b[0mFinished iteration #19 with objective value 0.43080303830400163. Current best value is 0.4153680594453024 \u001b[0m\n"]},{"data":{"text/plain":["29"]},"execution_count":40,"metadata":{},"output_type":"execute_result"}],"source":["from zoofs import HarrisHawkOptimization\n","def objective_function_topass(model, x_train_res, y_train_res, x_valid=None, y_valid=None):\n","\n","    cv = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)\n","\n","    scores = cross_val_score(\n","        clone(model),\n","        x_train_res,\n","        y_train_res,\n","        cv=cv,\n","        scoring=\"neg_log_loss\",\n","        n_jobs=-1\n","    )\n","\n","    return -np.mean(scores)\n","\n","\n","# Define base_model before it's used\n","base_model = RandomForestClassifier(random_state=42)\n","\n","algo_object=HarrisHawkOptimization(objective_function_topass,\n","                                   n_iteration=20,\n","                                   population_size=20,\n","                                   minimize=True)\n","algo_object.fit(\n","    base_model,\n","    x_train_res,\n","    y_train_res,\n","    x_train_res,   # dummy\n","    y_train_res,   # dummy\n","    verbose=True\n",")\n","\n","best_features1 = algo_object.best_feature_list\n","len(best_features1)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":171228,"status":"ok","timestamp":1766822352441,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"cDggO66fBn5w","outputId":"7ebe79f6-20fc-4663-e896-43d253fbffe7"},"outputs":[{"name":"stdout","output_type":"stream","text":["Accuracy: 0.8909090909090909\n","              precision    recall  f1-score   support\n","\n","           0       0.96      0.83      0.89        30\n","           1       0.83      0.96      0.89        25\n","\n","    accuracy                           0.89        55\n","   macro avg       0.89      0.90      0.89        55\n","weighted avg       0.90      0.89      0.89        55\n","\n","Confusion matrix:\n"," [[25  5]\n"," [ 1 24]]\n","ROC AUC: 0.9520000000000001\n","PR AUC (average precision): 0.9529771012177743\n"]}],"source":["opt.fit(x_train_res[best_features1], y_train_res)\n","y_pred = opt.predict(x_test[best_features1])\n","y_prob = opt.predict_proba(x_test[best_features1])[:, 1]\n","\n","print(\"Accuracy:\", accuracy_score(y_test, y_pred))\n","print(classification_report(y_test, y_pred))\n","print(\"Confusion matrix:\\n\", confusion_matrix(y_test, y_pred))\n","print(\"ROC AUC:\", roc_auc_score(y_test, y_prob))\n","print(\"PR AUC (average precision):\", average_precision_score(y_test, y_prob))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":56511,"status":"ok","timestamp":1766824360317,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"XVjfvQx9yXpx","outputId":"45ea8ce0-6b2f-4f0a-8564-bb048f72d6c6"},"outputs":[{"name":"stderr","output_type":"stream","text":["\u001b[32m [ 2025-12-27 08:27:55,483 ] \u001b[0mFinished iteration #0 with objective value 0.44011512408763015. Current best value is 0.44011512408763015 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:28:10,412 ] \u001b[0mFinished iteration #1 with objective value 0.4623293531549856. Current best value is 0.44011512408763015 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:28:25,121 ] \u001b[0mFinished iteration #2 with objective value 0.5267666322066337. Current best value is 0.44011512408763015 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:28:40,413 ] \u001b[0mFinished iteration #3 with objective value 0.45181059596508844. Current best value is 0.44011512408763015 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:28:56,006 ] \u001b[0mFinished iteration #4 with objective value 0.4824497538975435. Current best value is 0.44011512408763015 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:29:10,835 ] \u001b[0mFinished iteration #5 with objective value 0.4538274248258535. Current best value is 0.44011512408763015 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:29:25,719 ] \u001b[0mFinished iteration #6 with objective value 0.48645463241824627. Current best value is 0.44011512408763015 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:29:40,691 ] \u001b[0mFinished iteration #7 with objective value 0.44158295212226734. Current best value is 0.44011512408763015 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:29:55,510 ] \u001b[0mFinished iteration #8 with objective value 0.5343535026455319. Current best value is 0.44011512408763015 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:30:10,409 ] \u001b[0mFinished iteration #9 with objective value 0.43004553102836446. Current best value is 0.43004553102836446 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:30:26,370 ] \u001b[0mFinished iteration #10 with objective value 0.4854974667917344. Current best value is 0.43004553102836446 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:30:41,311 ] \u001b[0mFinished iteration #11 with objective value 0.4442501794018524. Current best value is 0.43004553102836446 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:30:56,165 ] \u001b[0mFinished iteration #12 with objective value 0.44088094047383386. Current best value is 0.43004553102836446 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:31:11,143 ] \u001b[0mFinished iteration #13 with objective value 0.4281640684714925. Current best value is 0.4281640684714925 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:31:25,772 ] \u001b[0mFinished iteration #14 with objective value 0.45583337443615174. Current best value is 0.4281640684714925 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:31:40,605 ] \u001b[0mFinished iteration #15 with objective value 0.4456325262778229. Current best value is 0.4281640684714925 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:31:56,247 ] \u001b[0mFinished iteration #16 with objective value 0.4651025805734392. Current best value is 0.4281640684714925 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:32:11,077 ] \u001b[0mFinished iteration #17 with objective value 0.43452301635505597. Current best value is 0.4281640684714925 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:32:25,711 ] \u001b[0mFinished iteration #18 with objective value 0.44703841616188206. Current best value is 0.4281640684714925 \u001b[0m\n","\u001b[32m [ 2025-12-27 08:32:40,339 ] \u001b[0mFinished iteration #19 with objective value 0.44046378492662946. Current best value is 0.4281640684714925 \u001b[0m\n"]},{"data":{"text/plain":["27"]},"execution_count":51,"metadata":{},"output_type":"execute_result"}],"source":["from zoofs import DragonFlyOptimization\n","from sklearn.model_selection import StratifiedKFold, cross_val_score\n","from sklearn.base import clone\n","from sklearn.ensemble import RandomForestClassifier\n","import numpy as np\n","def objective_function_topass(model, x_train_res, y_train_res, x_valid=None, y_valid=None):\n","\n","    cv = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)\n","\n","    scores = cross_val_score(\n","        clone(model),\n","        x_train_res,\n","        y_train_res,\n","        cv=cv,\n","        scoring=\"neg_log_loss\",\n","        n_jobs=-1\n","    )\n","\n","    return -np.mean(scores)\n","\n","\n","\n","base_model = RandomForestClassifier(random_state=42)\n","\n","algo_object=DragonFlyOptimization(objective_function_topass,n_iteration=20,\n","                                    population_size=20,method='sinusoidal',minimize=True)\n","algo_object.fit(\n","    base_model,\n","    x_train_res,\n","    y_train_res,\n","    x_train_res,\n","    y_train_res,\n","    verbose=True\n",")\n","\n","best_features2 = algo_object.best_feature_list\n","len(best_features2)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"jxtij5Qz1qbT","outputId":"f1f1155a-6625-42cc-e292-fc63b6eaea64"},"outputs":[{"name":"stdout","output_type":"stream","text":["Accuracy: 0.8909090909090909\n","              precision    recall  f1-score   support\n","\n","           0       0.93      0.87      0.90        30\n","           1       0.85      0.92      0.88        25\n","\n","    accuracy                           0.89        55\n","   macro avg       0.89      0.89      0.89        55\n","weighted avg       0.89      0.89      0.89        55\n","\n","Confusion matrix:\n"," [[26  4]\n"," [ 2 23]]\n","ROC AUC: 0.9546666666666667\n","PR AUC (average precision): 0.9609499035585991\n"]}],"source":["opt.fit(x_train_res[best_features2], y_train_res)\n","y_pred = opt.predict(x_test[best_features2])\n","y_prob = opt.predict_proba(x_test[best_features2])[:, 1]\n","\n","print(\"Accuracy:\", accuracy_score(y_test, y_pred))\n","print(classification_report(y_test, y_pred))\n","print(\"Confusion matrix:\\n\", confusion_matrix(y_test, y_pred))\n","print(\"ROC AUC:\", roc_auc_score(y_test, y_prob))\n","print(\"PR AUC (average precision):\", average_precision_score(y_test, y_prob))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":36,"status":"ok","timestamp":1766822909121,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"lWLRaMukHQFh","outputId":"49173f23-8dfc-4fce-902d-5fd1057a0d41"},"outputs":[{"data":{"text/plain":["[np.str_('cat__Varicella_1'),\n"," np.str_('cat__Varicella_2'),\n"," np.str_('cat__Mono or polysymptomatic_2'),\n"," np.str_('cat__Oligoclonal bands_0'),\n"," np.str_('cat__Oligoclonal bands_1'),\n"," np.str_('cat__Oligoclonal bands_2'),\n"," np.str_('cat__initial EDSS_1.0'),\n"," np.str_('cat__initial EDSS_2.0'),\n"," np.str_('cat__initial symptom_1.0'),\n"," np.str_('cat__initial symptom_2.0'),\n"," np.str_('cat__initial symptom_3.0'),\n"," np.str_('cat__initial symptom_6.0'),\n"," np.str_('cat__initial symptom_7.0'),\n"," np.str_('cat__initial symptom_9.0'),\n"," np.str_('cat__initial symptom_10.0'),\n"," np.str_('cat__initial symptom_11.0'),\n"," np.str_('cat__initial symptom_12.0'),\n"," np.str_('cat__initial symptom_13.0'),\n"," np.str_('cat__initial symptom_nan'),\n"," np.str_('cat__ final EDSS_1.0'),\n"," np.str_('cat__ final EDSS_2.0'),\n"," np.str_('remainder__Gender'),\n"," np.str_('remainder__LLSSEP'),\n"," np.str_('remainder__VEP'),\n"," np.str_('remainder__BAEP'),\n"," np.str_('remainder__Periventricular MRI'),\n"," np.str_('remainder__Infratentorial MRI')]"]},"execution_count":44,"metadata":{},"output_type":"execute_result"}],"source":["best_features2"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"cATiSUbS2jVW"},"outputs":[],"source":["# lst=[np.str_('cat__Varicella_1'),\n","#  np.str_('cat__Varicella_3'),\n","#  np.str_('cat__Mono or polysymptomatic_2'),\n","#  np.str_('cat__Oligoclonal bands_1'),\n","#  np.str_('cat__Oligoclonal bands_2'),\n","#  np.str_('cat__initial EDSS_3.0'),\n","#  np.str_('cat__initial symptom_1.0'),\n","#  np.str_('cat__initial symptom_2.0'),\n","#  np.str_('cat__initial symptom_4.0'),\n","#  np.str_('cat__initial symptom_6.0'),\n","#  np.str_('cat__initial symptom_7.0'),\n","#  np.str_('cat__initial symptom_10.0'),\n","#  np.str_('cat__initial symptom_13.0'),\n","#  np.str_('cat__initial symptom_14.0'),\n","#  np.str_('cat__initial symptom_15.0'),\n","#  np.str_('cat__initial symptom_nan'),\n","#  np.str_('cat__ final EDSS_1.0'),\n","#  np.str_('cat__ final EDSS_2.0'),\n","#  np.str_('cat__ final EDSS_3.0'),\n","#  np.str_('remainder__Age (y)'),\n","#  np.str_('remainder__ULSSEP'),\n","#  np.str_('remainder__VEP'),\n","#  np.str_('remainder__BAEP'),\n","#  np.str_('remainder__Periventricular MRI'),\n","#  np.str_('remainder__Infratentorial MRI')]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":373},"executionInfo":{"elapsed":48807,"status":"error","timestamp":1766823368954,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"W-fKg5kF21KX","outputId":"f2d6ab7b-337f-4e7a-a67d-33b32bf2dfa7"},"outputs":[{"ename":"KeyboardInterrupt","evalue":"","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m/tmp/ipython-input-4194862107.py\u001b[0m in \u001b[0;36m<cell line: 0>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mopt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx_train_res\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mlst\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my_train_res\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0my_pred\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mopt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpredict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx_test\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0my_prob\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mopt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpredict_proba\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx_test\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"Accuracy:\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maccuracy_score\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_test\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my_pred\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/skopt/searchcv.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, X, y, groups, callback, **fit_params)\u001b[0m\n\u001b[1;32m    540\u001b[0m             )\n\u001b[1;32m    541\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 542\u001b[0;31m         \u001b[0msuper\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0my\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mgroups\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mgroups\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mfit_params\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    543\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    544\u001b[0m         \u001b[0;31m# BaseSearchCV never ranked train scores,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/sklearn/base.py\u001b[0m in \u001b[0;36mwrapper\u001b[0;34m(estimator, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1387\u001b[0m                 )\n\u001b[1;32m   1388\u001b[0m             ):\n\u001b[0;32m-> 1389\u001b[0;31m                 \u001b[0;32mreturn\u001b[0m \u001b[0mfit_method\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mestimator\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1390\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1391\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mwrapper\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/sklearn/model_selection/_search.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, X, y, **params)\u001b[0m\n\u001b[1;32m   1022\u001b[0m                 \u001b[0;32mreturn\u001b[0m \u001b[0mresults\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1023\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1024\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_run_search\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mevaluate_candidates\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1025\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1026\u001b[0m             \u001b[0;31m# multimetric is determined here because in the case of a callable\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/skopt/searchcv.py\u001b[0m in \u001b[0;36m_run_search\u001b[0;34m(self, evaluate_candidates)\u001b[0m\n\u001b[1;32m    597\u001b[0m                 \u001b[0mn_points_adjusted\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmin\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mn_iter\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mn_points\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    598\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 599\u001b[0;31m                 optim_result, score_name = self._step(\n\u001b[0m\u001b[1;32m    600\u001b[0m                     \u001b[0msearch_space\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    601\u001b[0m                     \u001b[0moptimizer\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/skopt/searchcv.py\u001b[0m in \u001b[0;36m_step\u001b[0;34m(self, search_space, optimizer, score_name, evaluate_candidates, n_points)\u001b[0m\n\u001b[1;32m    443\u001b[0m         \u001b[0;34m\"\"\"Generate n_jobs parameters and evaluate them in parallel.\"\"\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    444\u001b[0m         \u001b[0;31m# get parameter values to evaluate\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 445\u001b[0;31m         \u001b[0mparams\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0moptimizer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mask\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mn_points\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mn_points\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    446\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    447\u001b[0m         \u001b[0;31m# convert parameters to python native types\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/skopt/optimizer/optimizer.py\u001b[0m in \u001b[0;36mask\u001b[0;34m(self, n_points, strategy)\u001b[0m\n\u001b[1;32m    436\u001b[0m         \u001b[0;31m# deletion of points with \"lie\" objective (the copy of\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    437\u001b[0m         \u001b[0;31m# oiptimizer is simply discarded)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 438\u001b[0;31m         \u001b[0mopt\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcopy\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrandom_state\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrng\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrandint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0miinfo\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mint32\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmax\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    439\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    440\u001b[0m         \u001b[0mX\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/skopt/optimizer/optimizer.py\u001b[0m in \u001b[0;36mcopy\u001b[0;34m(self, random_state)\u001b[0m\n\u001b[1;32m    378\u001b[0m             \u001b[0moptimizer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgains_\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcopy\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mgains_\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    379\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mXi\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 380\u001b[0;31m             \u001b[0moptimizer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_tell\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mXi\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0myi\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    381\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    382\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0moptimizer\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/skopt/optimizer/optimizer.py\u001b[0m in \u001b[0;36m_tell\u001b[0;34m(self, x, y, fit)\u001b[0m\n\u001b[1;32m    613\u001b[0m             \u001b[0;32mwith\u001b[0m \u001b[0mwarnings\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcatch_warnings\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    614\u001b[0m                 \u001b[0mwarnings\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msimplefilter\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"ignore\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 615\u001b[0;31m                 \u001b[0mest\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mspace\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtransform\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mXi\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0myi\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    616\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    617\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0mhasattr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m\"next_xs_\"\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0macq_func\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;34m\"gp_hedge\"\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/skopt/learning/gaussian_process/gpr.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, X, y)\u001b[0m\n\u001b[1;32m    201\u001b[0m                     \u001b[0mnoise_level\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mnoise\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnoise_level_bounds\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m\"fixed\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    202\u001b[0m                 )\n\u001b[0;32m--> 203\u001b[0;31m         \u001b[0msuper\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    204\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    205\u001b[0m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mnoise_\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/sklearn/base.py\u001b[0m in \u001b[0;36mwrapper\u001b[0;34m(estimator, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1387\u001b[0m                 )\n\u001b[1;32m   1388\u001b[0m             ):\n\u001b[0;32m-> 1389\u001b[0;31m                 \u001b[0;32mreturn\u001b[0m \u001b[0mfit_method\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mestimator\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1390\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1391\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mwrapper\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/sklearn/gaussian_process/_gpr.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, X, y)\u001b[0m\n\u001b[1;32m    324\u001b[0m                     \u001b[0mtheta_initial\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_rng\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0muniform\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mbounds\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mbounds\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    325\u001b[0m                     optima.append(\n\u001b[0;32m--> 326\u001b[0;31m                         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_constrained_optimization\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mobj_func\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtheta_initial\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mbounds\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    327\u001b[0m                     )\n\u001b[1;32m    328\u001b[0m             \u001b[0;31m# Select result from run with minimal (negative) log-marginal\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/sklearn/gaussian_process/_gpr.py\u001b[0m in \u001b[0;36m_constrained_optimization\u001b[0;34m(self, obj_func, initial_theta, bounds)\u001b[0m\n\u001b[1;32m    651\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m_constrained_optimization\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mobj_func\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minitial_theta\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mbounds\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    652\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0moptimizer\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;34m\"fmin_l_bfgs_b\"\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 653\u001b[0;31m             opt_res = scipy.optimize.minimize(\n\u001b[0m\u001b[1;32m    654\u001b[0m                 \u001b[0mobj_func\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    655\u001b[0m                 \u001b[0minitial_theta\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/scipy/optimize/_minimize.py\u001b[0m in \u001b[0;36mminimize\u001b[0;34m(fun, x0, args, method, jac, hess, hessp, bounds, constraints, tol, callback, options)\u001b[0m\n\u001b[1;32m    782\u001b[0m                                  **options)\n\u001b[1;32m    783\u001b[0m     \u001b[0;32melif\u001b[0m \u001b[0mmeth\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;34m'l-bfgs-b'\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 784\u001b[0;31m         res = _minimize_lbfgsb(fun, x0, args, jac, bounds,\n\u001b[0m\u001b[1;32m    785\u001b[0m                                callback=callback, **options)\n\u001b[1;32m    786\u001b[0m     \u001b[0;32melif\u001b[0m \u001b[0mmeth\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;34m'tnc'\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/scipy/optimize/_lbfgsb_py.py\u001b[0m in \u001b[0;36m_minimize_lbfgsb\u001b[0;34m(fun, x0, args, jac, bounds, disp, maxcor, ftol, gtol, eps, maxfun, maxiter, iprint, callback, maxls, finite_diff_rel_step, workers, **unknown_options)\u001b[0m\n\u001b[1;32m    459\u001b[0m         \u001b[0mg\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mg\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mastype\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfloat64\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    460\u001b[0m         \u001b[0;31m# x, f, g, wa, iwa, task, csave, lsave, isave, dsave = \\\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 461\u001b[0;31m         _lbfgsb.setulb(m, x, low_bnd, upper_bnd, nbd, f, g, factr, pgtol, wa,\n\u001b[0m\u001b[1;32m    462\u001b[0m                        iwa, task, lsave, isave, dsave, maxls, ln_task)\n\u001b[1;32m    463\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]}],"source":["# opt.fit(x_train_res[lst], y_train_res)\n","# y_pred = opt.predict(x_test[lst])\n","# y_prob = opt.predict_proba(x_test[lst])[:, 1]\n","\n","# print(\"Accuracy:\", accuracy_score(y_test, y_pred))\n","# print(classification_report(y_test, y_pred))\n","# print(\"Confusion matrix:\\n\", confusion_matrix(y_test, y_pred))\n","# print(\"ROC AUC:\", roc_auc_score(y_test, y_prob))\n","# print(\"PR AUC (average precision):\", average_precision_score(y_test, y_prob))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":478},"executionInfo":{"elapsed":321,"status":"ok","timestamp":1766823004963,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"JV1UqzB5X91f","outputId":"a5a6b7a9-15ac-4106-ba63-dbdc2c54ab7a"},"outputs":[{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"best_25_feat"},"text/html":["\n","  <div id=\"df-0f7990bc-0f83-4745-8575-6b45cfe53786\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>cat__Varicella_1</th>\n","      <th>cat__Varicella_3</th>\n","      <th>cat__Mono or polysymptomatic_2</th>\n","      <th>cat__Oligoclonal bands_1</th>\n","      <th>cat__Oligoclonal bands_2</th>\n","      <th>cat__initial EDSS_3.0</th>\n","      <th>cat__initial symptom_1.0</th>\n","      <th>cat__initial symptom_2.0</th>\n","      <th>cat__initial symptom_4.0</th>\n","      <th>cat__initial symptom_6.0</th>\n","      <th>...</th>\n","      <th>cat__initial symptom_nan</th>\n","      <th>cat__ final EDSS_1.0</th>\n","      <th>cat__ final EDSS_2.0</th>\n","      <th>cat__ final EDSS_3.0</th>\n","      <th>remainder__Age (y)</th>\n","      <th>remainder__ULSSEP</th>\n","      <th>remainder__VEP</th>\n","      <th>remainder__BAEP</th>\n","      <th>remainder__Periventricular MRI</th>\n","      <th>remainder__Infratentorial MRI</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>34</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>61</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>22</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>41</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>34</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>268</th>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>31</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>269</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>21</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>270</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>19</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>271</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>32</td>\n","      <td>1</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>272</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>...</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>77</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>273 rows × 25 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0f7990bc-0f83-4745-8575-6b45cfe53786')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-0f7990bc-0f83-4745-8575-6b45cfe53786 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-0f7990bc-0f83-4745-8575-6b45cfe53786');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","    <div id=\"df-ba613031-96e7-465e-9dab-716074f28c34\">\n","      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-ba613031-96e7-465e-9dab-716074f28c34')\"\n","                title=\"Suggest charts\"\n","                style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","      </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","      <script>\n","        async function quickchart(key) {\n","          const quickchartButtonEl =\n","            document.querySelector('#' + key + ' button');\n","          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","          quickchartButtonEl.classList.add('colab-df-spinner');\n","          try {\n","            const charts = await google.colab.kernel.invokeFunction(\n","                'suggestCharts', [key], {});\n","          } catch (error) {\n","            console.error('Error during call to suggestCharts:', error);\n","          }\n","          quickchartButtonEl.classList.remove('colab-df-spinner');\n","          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","        }\n","        (() => {\n","          let quickchartButtonEl =\n","            document.querySelector('#df-ba613031-96e7-465e-9dab-716074f28c34 button');\n","          quickchartButtonEl.style.display =\n","            google.colab.kernel.accessAllowed ? 'block' : 'none';\n","        })();\n","      </script>\n","    </div>\n","\n","  <div id=\"id_1313443f-27d6-42a0-8732-63032340dc7b\">\n","    <style>\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    </style>\n","    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('best_25_feat')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n","  </svg>\n","    </button>\n","    <script>\n","      (() => {\n","      const buttonEl =\n","        document.querySelector('#id_1313443f-27d6-42a0-8732-63032340dc7b button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () => {\n","        google.colab.notebook.generateWithVariable('best_25_feat');\n","      }\n","      })();\n","    </script>\n","  </div>\n","\n","    </div>\n","  </div>\n"],"text/plain":["     cat__Varicella_1  cat__Varicella_3  cat__Mono or polysymptomatic_2  \\\n","0                   1                 0                               0   \n","1                   0                 0                               1   \n","2                   1                 0                               0   \n","3                   1                 0                               1   \n","4                   1                 0                               1   \n","..                ...               ...                             ...   \n","268                 1                 0                               1   \n","269                 0                 1                               1   \n","270                 0                 1                               1   \n","271                 0                 1                               1   \n","272                 0                 1                               0   \n","\n","     cat__Oligoclonal bands_1  cat__Oligoclonal bands_2  \\\n","0                           0                         0   \n","1                           1                         0   \n","2                           1                         0   \n","3                           1                         0   \n","4                           0                         0   \n","..                        ...                       ...   \n","268                         0                         0   \n","269                         1                         0   \n","270                         0                         0   \n","271                         1                         0   \n","272                         0                         0   \n","\n","     cat__initial EDSS_3.0  cat__initial symptom_1.0  \\\n","0                        0                         0   \n","1                        0                         0   \n","2                        0                         0   \n","3                        0                         0   \n","4                        0                         0   \n","..                     ...                       ...   \n","268                      0                         0   \n","269                      0                         0   \n","270                      0                         0   \n","271                      0                         0   \n","272                      0                         0   \n","\n","     cat__initial symptom_2.0  cat__initial symptom_4.0  \\\n","0                           1                         0   \n","1                           0                         0   \n","2                           0                         0   \n","3                           0                         0   \n","4                           0                         0   \n","..                        ...                       ...   \n","268                         0                         0   \n","269                         0                         0   \n","270                         0                         0   \n","271                         0                         0   \n","272                         1                         0   \n","\n","     cat__initial symptom_6.0  ...  cat__initial symptom_nan  \\\n","0                           0  ...                         0   \n","1                           0  ...                         0   \n","2                           0  ...                         0   \n","3                           0  ...                         0   \n","4                           1  ...                         0   \n","..                        ...  ...                       ...   \n","268                         0  ...                         0   \n","269                         0  ...                         0   \n","270                         0  ...                         0   \n","271                         0  ...                         0   \n","272                         0  ...                         0   \n","\n","     cat__ final EDSS_1.0  cat__ final EDSS_2.0  cat__ final EDSS_3.0  \\\n","0                       1                     0                     0   \n","1                       0                     1                     0   \n","2                       1                     0                     0   \n","3                       1                     0                     0   \n","4                       1                     0                     0   \n","..                    ...                   ...                   ...   \n","268                     1                     0                     0   \n","269                     1                     0                     0   \n","270                     1                     0                     0   \n","271                     1                     0                     0   \n","272                     1                     0                     0   \n","\n","     remainder__Age (y)  remainder__ULSSEP  remainder__VEP  remainder__BAEP  \\\n","0                    34                  1               0                0   \n","1                    61                  0               1                0   \n","2                    22                  0               0                0   \n","3                    41                  1               1                0   \n","4                    34                  0               0                0   \n","..                  ...                ...             ...              ...   \n","268                  31                  0               0                0   \n","269                  21                  0               0                0   \n","270                  19                  1               1                0   \n","271                  32                  1               1                0   \n","272                  77                  1               0                0   \n","\n","     remainder__Periventricular MRI  remainder__Infratentorial MRI  \n","0                                 0                              0  \n","1                                 0                              0  \n","2                                 0                              0  \n","3                                 1                              0  \n","4                                 1                              0  \n","..                              ...                            ...  \n","268                               0                              0  \n","269                               0                              0  \n","270                               0                              0  \n","271                               1                              1  \n","272                               0                              0  \n","\n","[273 rows x 25 columns]"]},"execution_count":46,"metadata":{},"output_type":"execute_result"}],"source":["# best_25_feat=data[lst]\n","# best_25_feat"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fex-K97UYdyh"},"outputs":[],"source":["# best_25_feat.to_csv('best_25_feat.csv',index=False)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"WGWzIW--3BYP"},"outputs":[],"source":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BvTGPmEnY8Or"},"outputs":[],"source":["y.shape"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":460},"executionInfo":{"elapsed":476576,"status":"error","timestamp":1766825196126,"user":{"displayName":"Yoga Shree","userId":"02831029739860348092"},"user_tz":-330},"id":"Z9EMBlu-LkQX","outputId":"fe0f5108-e4bb-4541-a41e-3a0ca5db783b"},"outputs":[{"output_type":"stream","name":"stdout","text":["Iteration 1/30 | Best fitness: 0.8668\n","Iteration 2/30 | Best fitness: 0.8668\n","Iteration 3/30 | Best fitness: 0.8668\n","Iteration 4/30 | Best fitness: 0.8668\n","Iteration 5/30 | Best fitness: 0.8709\n","Iteration 6/30 | Best fitness: 0.8709\n"]},{"output_type":"error","ename":"KeyboardInterrupt","evalue":"","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","\u001b[0;32m/tmp/ipython-input-403678218.py\u001b[0m in \u001b[0;36m<cell line: 0>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     70\u001b[0m \u001b[0;31m# RUN SSA FEATURE SELECTION\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     71\u001b[0m \u001b[0;31m# ============================================================\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 72\u001b[0;31m best_feature_mask = sparrow_search_fs(\n\u001b[0m\u001b[1;32m     73\u001b[0m     \u001b[0mx_train_res\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     74\u001b[0m     \u001b[0my_train_res\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/tmp/ipython-input-403678218.py\u001b[0m in \u001b[0;36msparrow_search_fs\u001b[0;34m(x, y, pop_size, max_iter)\u001b[0m\n\u001b[1;32m     55\u001b[0m             \u001b[0mpopulation\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mi\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mclip\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpopulation\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mi\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m0\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     56\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 57\u001b[0;31m         \u001b[0mfitness\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0marray\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mfs_fitness\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mind\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mind\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mpopulation\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     58\u001b[0m         \u001b[0mcurr_best\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0margmax\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfitness\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     59\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/tmp/ipython-input-403678218.py\u001b[0m in \u001b[0;36mfs_fitness\u001b[0;34m(mask, X, y, alpha)\u001b[0m\n\u001b[1;32m     21\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     22\u001b[0m     \u001b[0;32mfor\u001b[0m \u001b[0mtr\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mval\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mcv\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msplit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX_selected\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 23\u001b[0;31m         \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX_selected\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mtr\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mtr\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     24\u001b[0m         \u001b[0my_proba\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpredict_proba\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX_selected\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mval\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     25\u001b[0m         \u001b[0maucs\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mappend\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mroc_auc_score\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mval\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0my_proba\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/sklearn/base.py\u001b[0m in \u001b[0;36mwrapper\u001b[0;34m(estimator, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1387\u001b[0m                 )\n\u001b[1;32m   1388\u001b[0m             ):\n\u001b[0;32m-> 1389\u001b[0;31m                 \u001b[0;32mreturn\u001b[0m \u001b[0mfit_method\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mestimator\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1390\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1391\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0mwrapper\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/sklearn/ensemble/_forest.py\u001b[0m in \u001b[0;36mfit\u001b[0;34m(self, X, y, sample_weight)\u001b[0m\n\u001b[1;32m    485\u001b[0m             \u001b[0;31m# parallel_backend contexts set at a higher level,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    486\u001b[0m             \u001b[0;31m# since correctness does not rely on using threads.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 487\u001b[0;31m             trees = Parallel(\n\u001b[0m\u001b[1;32m    488\u001b[0m                 \u001b[0mn_jobs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mn_jobs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    489\u001b[0m                 \u001b[0mverbose\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mverbose\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/sklearn/utils/parallel.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, iterable)\u001b[0m\n\u001b[1;32m     75\u001b[0m             \u001b[0;32mfor\u001b[0m \u001b[0mdelayed_func\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mkwargs\u001b[0m \u001b[0;32min\u001b[0m \u001b[0miterable\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     76\u001b[0m         )\n\u001b[0;32m---> 77\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0msuper\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__call__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0miterable_with_config\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     78\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     79\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/joblib/parallel.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, iterable)\u001b[0m\n\u001b[1;32m   2070\u001b[0m         \u001b[0mnext\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0moutput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2071\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2072\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0moutput\u001b[0m \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mreturn_generator\u001b[0m \u001b[0;32melse\u001b[0m \u001b[0mlist\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0moutput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2073\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2074\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0m__repr__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/joblib/parallel.py\u001b[0m in \u001b[0;36m_get_outputs\u001b[0;34m(self, iterator, pre_dispatch)\u001b[0m\n\u001b[1;32m   1680\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1681\u001b[0m             \u001b[0;32mwith\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_backend\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mretrieval_context\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1682\u001b[0;31m                 \u001b[0;32myield\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_retrieve\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1683\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1684\u001b[0m         \u001b[0;32mexcept\u001b[0m \u001b[0mGeneratorExit\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.12/dist-packages/joblib/parallel.py\u001b[0m in \u001b[0;36m_retrieve\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1798\u001b[0m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_jobs\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_status\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtimeout\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0mTASK_PENDING\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1799\u001b[0m                 ):\n\u001b[0;32m-> 1800\u001b[0;31m                     \u001b[0mtime\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msleep\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m0.01\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1801\u001b[0m                     \u001b[0;32mcontinue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1802\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]}],"source":["\n","# ============================================================\n","# FITNESS FUNCTION (FEATURE SELECTION)\n","# ============================================================\n","def fs_fitness(mask, X, y, alpha=0.99):\n","    mask = mask.astype(int)\n","\n","    if np.sum(mask) == 0:\n","        return 0\n","\n","    X_selected = X[:, mask == 1]\n","\n","    model = RandomForestClassifier(\n","        n_estimators=300,\n","        max_depth=None,\n","        random_state=42,\n","        n_jobs=-1\n","    )\n","\n","    cv = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)\n","    aucs = []\n","\n","    for tr, val in cv.split(X_selected, y):\n","        model.fit(X_selected[tr], y[tr])\n","        y_proba = model.predict_proba(X_selected[val])[:, 1]\n","        aucs.append(roc_auc_score(y[val], y_proba))\n","\n","    auc = np.mean(aucs)\n","    feature_ratio = np.sum(mask) / len(mask)\n","\n","    return alpha * auc + (1 - alpha) * (1 - feature_ratio)\n","\n","\n","# ============================================================\n","# SPARROW SEARCH ALGORITHM (FEATURE SELECTION)\n","# ============================================================\n","def sparrow_search_fs(x, y, pop_size=20, max_iter=30):\n","    dim = x.shape[1]\n","\n","    population = np.random.randint(0, 2, size=(pop_size, dim))\n","    fitness = np.array([fs_fitness(ind, x, y) for ind in population])\n","\n","    best_idx = np.argmax(fitness)\n","    best_mask = population[best_idx]\n","    best_score = fitness[best_idx]\n","\n","    for t in range(max_iter):\n","        for i in range(pop_size):\n","            r1, r2 = np.random.rand(), np.random.rand()\n","\n","            if i < pop_size * 0.2:  # Producers\n","                population[i] = population[i] ^ (np.random.rand(dim) < r1)\n","            else:  # Scroungers\n","                population[i] = best_mask ^ (np.random.rand(dim) < r2)\n","\n","            population[i] = np.clip(population[i], 0, 1)\n","\n","        fitness = np.array([fs_fitness(ind, x, y) for ind in population])\n","        curr_best = np.argmax(fitness)\n","\n","        if fitness[curr_best] > best_score:\n","            best_score = fitness[curr_best]\n","            best_mask = population[curr_best]\n","\n","        print(f\"Iteration {t+1}/{max_iter} | Best fitness: {best_score:.4f}\")\n","\n","    return best_mask\n","\n","\n","# ============================================================\n","# RUN SSA FEATURE SELECTION\n","# ============================================================\n","best_feature_mask = sparrow_search_fs(\n","    x_train_res.values,\n","    y_train_res.values,\n","    pop_size=20,\n","    max_iter=30\n",")\n","\n","selected_features = x_train_res.columns[best_feature_mask == 1]\n","\n","print(\"\\nNumber of selected features:\", len(selected_features))\n","print(\"Selected features:\")\n","for f in selected_features:\n","    print(\"-\", f)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"BNgYpDCxO3Jt"},"outputs":[],"source":[]}],"metadata":{"accelerator":"GPU","colab":{"gpuType":"T4","provenance":[],"authorship_tag":"ABX9TyNCkt9Cu8oH/ccY5FXNDG+7"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}